{"title":"Regression","markdown":{"yaml":{"title":"Regression","number-sections":true,"number-offset":11},"headingText":"Regression","containsRefs":false,"markdown":"\n\n```{r chapter-10-setup, include= FALSE, echo=FALSE, warning=FALSE}\nlibrary(\"mosaic\") \nlibrary(\"NHANES\")\nMetacarpal<- read.csv( \"https://krkozak.github.io/MAT160/metacarpal.csv\")\nHouse<- read.csv( \"https://krkozak.github.io/MAT160/house.csv\")\nFertility<- read.csv( \"https://krkozak.github.io/MAT160/fertility.csv\") \nFert_prenatal<- read.csv( \"https://krkozak.github.io/MAT160/fertility_prenatal.csv\") \nHotdog<-read.csv( \"https://krkozak.github.io/MAT160/hotdog_beef_poultry.csv\") \n```\n\n**Before you begin, Click to expand the box below to review the process for importing a dataset.**\n\n::: {#Importing-Beer_data-to-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'}  Importing Data to Rguroo\"} \n\n1. Open the **Data** toolbox in Rguroo.  \n2. From the [Data Import]{.dpd} dropdown, select [Dataset Repository]{.fun}.  \n3. In the top search box, type [kozak]{.typein}, then select the [Statistics Using Technology – Kozak]{.repo} repository.  \n4. In the middle search box, type the first few letters of the dataset name, and choose your desired dataset name that appears in the lower panel.  \n5. Click the [Import]{.button}. The dataset will be imported to your Rguroo account.\n6. Click [Close]{.button} to exit the dialog.  \n7. To view the dataset, double-click the dataset name under the **Data** toolbox list.\n\n:::\n\n\n\n\nThe previous chapter focused on comparing populations to determine whether there is a difference between them. In those situations, we examined two random variables that measured the same or very similar quantities. In this chapter, we shift our focus to situations where the variables do not need to measure the same thing. Instead of comparing groups, we investigate whether a relationship exists between two or more variables. To study this relationship, we use regression to model the linear relationship between variables and correlation to measure the strength and direction of that linear relationship.\n\nThere are many types of relationships that can exist between variables, not just linear ones. In this book, we will focus only on linear relationships. However, it is important to recognize that other types of relationships can also be used to describe and model data, depending on the situation.\n\n\n### Introduction to Regression and Correlation\n\nWhen comparing different variables, two questions naturally arise: “Is there a relationship between the variables?” and “How strong is that relationship?” These questions can be answered using regression and correlation. Regression helps determine whether a relationship exists (in this book, we focus only on linear relationships), while correlation measures the strength of the linear relationship.\n\nWhen comparing different variables, two questions naturally arise: “Is there a relationship between the variables?” and “How strong is that relationship?” These questions can be answered using **regression** and **correlation**. Regression helps determine whether a relationship exists (in this book, we focus only on linear relationships), while correlation measures the strength of the linear relationship.\n\nTo better understand these ideas, it is helpful to clearly define the roles the variables play in this analysis. The **response** variable is the variable whose variability we are trying to explain or predict. The variable used to explain the change (or variability) in the response variable is called the **explanatory variable** or **predictor variable**. More generally, any variables that help explain changes in a response variable are referred to as **predictors** or **covariates**. To introduce the concepts of regression and correlation more fully, it is helpful to examine a set of data.\n\n::: {#exm-determine-relationship}\n## Determining if There is a Relationship\n\nIs there a relationship between the alcohol content and the number of calories in a 12-ounce beer? To determine whether such a relationship exists, we examine a dataset of 227 beers that includes their alcohol content and calorie counts (Find Out How Many Calories in Beer?, 2019). \n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this example is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [beer_data]{.data}.\nTable @tbl-Beer displays the first five rows of the dataset. A complete description of the variables is provided in the  [dataset code book](#code-book-beer) that follows.\n\n:::\n\n```{r chapter-10-beer-data, echo=FALSE}\n#| tbl-alt: \"Head of beer Dataset\"\n#| label: tbl-Beer\n#| tbl-cap: \"Alcohol and Calorie Content in Beer\"\nBeer <- read.csv( '/Users/mori/CSU Fullerton Dropbox/Mortaza Jamshidian/Statistics Text Using Rguroo Positron/Statistics-Using-Technology-book/Datasets Revised or New/beer_data.csv') \nknitr::kable(head(Beer))\n```\n\n::: {#code-book-beer .callout-tip .codebook collapse=\"true\"}\n\n## Code book for Dataset Beer\n\n**Description** Collection of the most popular beers from large breweries. The data is of the calories, carbs and alcohol of a specific beer. The data is shown for a 12 ounce serving. The collection includes both domestic and import beer. For the imported beers the information is per 12 oz. serving even though many imports come in pints.\n\nThis dataset contains the following columns:\n\n[beer]{.var}: The name of the beer.\n\n[brewery]{.var}: the brewery that brews the beer.\n\n[location]{.var}: whether the beer is brewed in the U.S. (domestic) or brewed in another country (import).\n\n[alcohol]{.var}: the percent alcohol content of the beer.\n\n[calories]{.var}: the number of calories in the beer.\n\n[carbs]{.var}: the amount of carbohydrates in the beer (g).\n\n[Source](https://www.beer100.com/beer-calories): Find Out How Many Calories in Beer? (n.d.). Retrieved July 21, 2019. (https://www.beer100.com/beer-calories)\n\nReferences: (Find Out How Many Calories in Beer?, 2019)\n\n:::\n\n**Solution** \n\nTo aid in figuring out if there is a relationship between the alcohol content and the number of calories, it helps to draw a scatter plot of the data. First, it is helpful to state the variables, and since variables in an algebra class are typically represented as $x$ and $y$, we use those labels  here. It helps to state which variable is $x$ (explanatory or predictor) and which is $y$ (response).\n\nState variables\n\n$x$ = percent alcohol content in the beer; [alcohol]{.var}\n\n$y$ = number of calories in 12 ounce beer; [calories]{.var}\n\n\n:::: {#Creating-scatterplot-of-Calories-vs-Alcohol-Content-in-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Creating scatter plot of Calories vs. Alcohol Content\"}\n\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Plots** toolbox in Rguroo.  \n2. Open the [Create Plot]{.dpd} dropdown and select [scatter plot]{.fun}. This opens the scatter plot dialog.  \n3. In the scatter plot dialog, choose the [beer_data]{.data} dataset from the [Dataset]{.dpd} dropdown.  \n4. Choose the [alcohol]{.var} variable from the [Predictor (x)]{.dpd} dropdown.  \n5. Choose the [calories]{.var} variable from the [Response (y)]{.dpd} dropdown.  \n6. **(Optional)** In the **Label** section of the dialog:  \n   - Enter [Calories versus Alcohol Content in Beer]{.typein} in the [Title]{.des} textbox.  \n   - Enter [Alcohol Content]{.typein} in the [X-Axis]{.des} textbox.  \n   - Enter [Number of Calories]{.typein} in the [Y-Axis]{.des} textbox.  \n7. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to see a preview of the scatter plot.\n8. In the ![Save as](Rguroo_Icons/save_as.png) textbox, enter the name [AlcoholCalorieScatter]{.typein} for the scatter plot.\nClick the button to save the scatter plot to your Rguroo account.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![scatter plot dialog showing settings for plotting alcohol content versus calories.\n](Rguroo_dialogs/Regression/scatterplot_dialog.png){width=500px}\n\n:::\n\n::::\n\n```{r,echo=FALSE}\n#| fig-alt: \"Scatter plot of alcohol content versus calories with dots following somewhat along a line\"\n#| warning: FALSE\n#| label: fig-Beer-point\n#| fig-cap: \"Calories versus Alcohol Content in Beer\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieScatter.svg\")\n```\n\nThe scatter plot shown in @fig-Beer-point looks fairly linear, meaning the points tend to fall along a straight-line pattern rather than a curved one.\n\n### Finding the regression line\n\nTo find the equation for the linear relationship, the process of regression is used to determine the line that best fits the data (sometimes called the best-fitting line). The process is to draw a line through the data and measure the vertical distance from each point to the line. These distances are called the **residuals**. The regression line is the line that makes the sum of the square of the residuals as small as possible, which is why it is sometimes called the least squares line. @fig-Beer-point-line displays the regression line on the scatter plot of the Number of Calories versus Alcohol Content.\n\n```{r beer10-point-lm, echo=FALSE}\n#| fig-alt: \"Scatter plot with regression line on plot\"\n#| warning: FALSE\n#| label: fig-Beer-point-line\n#| fig-cap: \"Scatter Plot of Beer Data with Regression Line\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieScatterLS.svg\")\n```\n\nTo add a regression (least squares) line to the scatter plot in Rguroo, you simply select the checkbox [LS Line]{.des} in the **superimpose** section of the [Scatterplot]{.dialog} dialog, as shown in @fig-scatterplot_dialog_LS. \n\n```{r scatterplot_dialog_LS, echo=FALSE}\n#| fig-alt: \"Rguroo Dialog Showing How to Add a Regression Line\"\n#| warning: FALSE\n#| label: fig-scatterplot_dialog_LS\n#| fig-cap: \"Rguroo Dialog Showing How to Add a Regression Line\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_dialogs/Regression/scatterplot_dialog_LS.png\")\n```\n\n\nGiven a collection of paired sample data, the regression equation is $\\hat{y}=b +mx$, where the slope = $m$ and the $y$-intercept = $(0,b)$. \n\n\nThe **independent variable** (the $x$-value) corresponds to the **explanatory** or **predictor** variable, the variable used to predict or explain changes in another variable. The **dependent variable** (the $y$-value) corresponds to the **response** variable—the variable whose values change in relation to the predictor. In our example, alcohol content is the predictor (independent, $x$) variable, and the number of calories is the response (dependent, $y$) variable, since it makes more sense to predict calories from alcohol content rather than vice versa.\n\nThe **residuals** are the difference between the actual observed values of the response and the corresponding estimated (predicted) values, namely $\\text{residual} = y - \\hat{y}$.\n\nAs we will show, the [Linear Regression]{.fun} function in the Analytics toolbox is used in Rguroo to fit a linear model, producing both the equation of the regression line and the associated residuals.\n\n### The Regression Equation and Prediction\n\n::: {#exm-find-regression-equation}\n\n## Find the Equation of the Regression Line\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer? To determine if there is one, we examine the sample of beer's alcohol content and calories, portion of which is shown in @tbl-Beer (Find Out How Many Calories in Beer?, 2019).\n\na.  Find the regression equation between alcohol content and calories.\nb.  Use the regression equation to find the number of calories when the alcohol content is 7%.\nc.  Use the regression equation to find the number of calories when the alcohol content is 14%.\n\n:::\n\n**Solution**\n\na.  Find the regression equation between alcohol content and calories.\n\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nClick to expand the box below to see how to obtain the regression equation.\n\n:::: {#Finding-the-Regression-Equation-in-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Finding the Regression Equation for the Beer Data\"}\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Analytics** toolbox in Rguroo.  \n2. Open the [Analysis]{.dpd} dropdown and select [Linear Regression]{.fun} → [Simple Regression]{.fun}. This opens the Simple Linear Regression dialog.  \n3. From the [Dataset]{.dpd} dropdown, choose the [beer_data]{.data} dataset.  \n4. From the [Predictor (x)]{.dpd} dropdown, choose the [alcohol]{.var} variable.  \n5. From the [Response (y)]{.dpd} dropdown, choose the [calories]{.var} variable.  \n6. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to view a preview of the regression results.\n7. Click the ![Save as](Rguroo_Icons/save_as.png) button to save the regression results as [AlcoholCalorieRegress]{.typein}.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![Simple Linear Regression dialog in Rguroo](Rguroo_dialogs/Regression/AlcoholCalorieRegress_dialog.png){width=500px}\n\n:::\n\n::: {.callout-tip .inner-callout collapse=\"true\" title=\"Rguroo output: Linear Regression for Beer Data\"}\n\n<div tabindex=\"0\" class=\"rg-iframe-wrapper\">\n  <iframe\n    src=\"Rguroo_html_output/RegressionHtmlOtput/AlcoholCalorieRegress_docx/AlcoholCalorieRegress.html\"\n    class=\"rg-iframe\"\n    title=\"Rguroo output: Linear Regression for Beer Data\">\n  </iframe>\n</div>\n\n:::\n\n::::\n\n```{r chapter-10-beer-lm-model, echo=FALSE, eval=FALSE}\nlm(calories~alcohol, data=Beer)\n```\n\nThe following is a portion of the output from Rguroo for this regression analysis.\n\n```{r AlcoholCalorieLSEstimates, echo=FALSE}\n#| label: tbl-Beer-lm-model\n#| tbl-cap: \"Data and model summary for Alcohol Content versus Calories\"\n#| out-width: \"90%\"\n#| fig-alt: \"Regression output for alcohol content versus calories\"\n#| warning: FALSE\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieLSEstimates.png\")\n```\n\nThis table shows various information about the regression analysis. In particular, the last row, labeled “Equation of Least Squares Line,” gives the estimates for the slope and the $y$-intercept. Note that the equation states *calories* in place of $y$ and *alcohol* in place of $x$.\n\nFrom this, rounding the values,  you can see that the y-intercept is 14.5 and the slope is 2672.4. So the regression equation is $\\hat{y}=2672.4x+14.5$.\n\nRemember, this is an estimate for the true regression equation. A different sample would produce a different estimate.\n\nWhat does the slope mean in the context of this problem?\n\nThe number of calories increases by about 26.72 calories for every 1% increase in alcohol content. In the regression output, the slope is shown as 2672, which looks much larger. This happens because alcohol content is recorded in the data as a decimal rather than a percent. For example, 1% alcohol is written as 0.01 in the dataset. The slope of 2672 therefore represents the change in calories for a 1.00 (or 100%) increase in alcohol content. To interpret the slope in terms of a 1% increase, we divide 2672 by 100, which gives 26.72 calories.\n\nThe $y$-intercept in many cases is meaningless. In this case, it means that if a drink has 0 alcohol content, then it would have 14.3 calories which maybe a reasonable value. \n\nb.  Use the regression equation to find the number of calories when the alcohol content is 7.00%.\n\nTo make a prediction, we substitute the given alcohol content (expressed as a decimal) into the regression equation and compute the corresponding fitted value. In this example, we want to predict the number of calories for a beer with 7% alcohol content. Since 7% expressed as a decimal is 0.07, we substitute $x = 0.07$ into the regression equation:\n$$\n\\hat{y} = 2672 \\times 0.07 + 14.3 = 201.34.\n$$\n\nThis value, 201.34, is the predicted number of calories for a beer whose alcohol content is 7\\%. So, if you are drinking a beer that has 7\\% alcohol content, then it probably has close to 200 calories.\n\nConsidering all the data, the mean number of calories is 154.5. However, for beers with 7\\% alcohol content, the predicted value of 201 calories is a more appropriate estimate because the beers in the dataset with 7\\% alcohol all have between 160 and 231 calories. Thus, when estimating calories for a specific alcohol content, the regression equation provides a more relevant and accurate estimate than simply using the overall mean.\n\nc.  Use the regression equation to find the number of calories when the alcohol content is 14%.\n\n$$\\hat{y}=2672*0.14+14.3=388.38$$\n\nYou can also use Rguroo to obtain predicted values for specified value of $x$. For example, to get the predicted values for alcohol contents of 7% and 14%, enter 0.07 and 0.14 (separated by a comma) in the textbox labeled [Predict at new x value(s)]{.des} in the [Simple Linear Regression]{.dialog} dialog as shown in @fig-AlcoholCalorieRegress_pred below. \n\n```{r AlcoholCalorieRegress_pred, echo=FALSE}\n#| fig-alt: \"Predicting calories for alcohol contents of 7.00% and 14.00% in Rguroo\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_pred\n#| fig-cap: \"Predicting Calories for Alcohol Contents of 7.00% and 14.00% in Rguroo\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_pred.png\")\n```\n\n\nThe predicted values output from Rguroo is shown in @fig-AlcoholCaloriePredOutput below. These values are the same as those that we computed using the formula directly.\n\n```{r AlcoholCaloriePredOutput, echo=FALSE}\n#| fig-alt: \"Rguroo output showing predicted calories for alcohol contents of 7.00% and 14.00%\"\n#| warning: FALSE\n#| label: fig-AlcoholCaloriePredOutput\n#| fig-cap: \"Rguroo Output Showing Predicted Calories for Alcohol Contents of 7.00% and 14.00%\"\n#| out-width: \"90%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/AlcoholCaloriePredOutput.png\")\n```\n\n**Extrapolation and Interpolation**\n\nIf you are drinking a beer that is 14% alcohol content, then it probably has close to 388 calories. Since, on average, a 12% alcohol beer has 330 calories, you might expect a 14% beer to have more calories than this. However, the maximum alcohol content in our dataset is 12%. The estimate for a 14% beer is therefore an example of **extrapolation**, because it is a prediction for an $x$-value outside the range of the data used to fit the model. It is not a good idea to predict values that fall far outside the range of the original data, because we cannot be sure that the regression relationship remains valid beyond the observed $x$-values.\n\nNotice that 7% alcohol is within the range of the original $x$-values. Predicting a value for an $x$-value inside the observed range is called **interpolation**. When you interpolate, you can usually feel confident that the predicted value will be close to the true value because the model was created using data within that range and is intended to describe relationships only there. When you extrapolate, however, you cannot be sure the prediction is close to the true value, because the relationship may change for $x$-values beyond those observed when the model was created.\n\n<!-- Discuss: The following example is not clear and its relationship to linear regression is not clear. . So I replaced it.\n\nAnother example of extrapolation is when you use regression to come up with an equation to predict the growth of a city, like Flagstaff, AZ. Based on analysis it was determined that the population of Flagstaff would be well over 50,000 by 1995. However, when a census was undertaken in 1995, the population was less than 50,000. This is because they extrapolated and the growth factor they were using had obviously changed from the early 1990's. Growth factors can change for many reasons, such as employment growth, employment stagnation, disease, articles saying great place to live, etc. Realize that when you extrapolate, your predicted value may not be anywhere close to the actual value that you observe.\n-->\n\nAnother example of extrapolation is the relationship between age and height.\nThis relationship is approximately linear only during middle childhood,\nroughly between ages 2 and 10. Suppose we model height (in inches) as a\nlinear function of age (in years) using the equation\n\nHeight = 30 + 2.5 × Age.\n\nFor example, to predict the height of a child who is 6 years old\n(an interpolation because 6 is within the 2–10 range), we substitute Age = 6:\n\nHeight = 30 + 2.5 × 6 = 45 inches.\n\nHowever, using the same model to predict height at age 30 represents an\nextrapolation, since age 30 is far outside the range where the linear\nrelationship holds. Substituting Age = 30 gives:\n\nHeight = 30 + 2.5 × 30 = 105 inches,\n\na clearly unrealistic value. This illustrates why extrapolation can lead\nto misleading conclusions.\n\nBy the way, the slope of 2.5  here means that for every one year increase in age, the height increases by 2.5 inches. However, in this case, the $y$-intercept is not meaningful. The $y$-intercept is 30 inches, which would be the predicted height of a newborn baby (age 0). This is not a reasonable value since newborn babies are typically about 20 inches long. So in this case, the $y$-intercept is not meaningful. \n\n<!-- Revised: This may be reasonable, but remember this value is an extrapolation so it may be wrong. (Mynote: actually it is not an extrapolation since 0% is within the range of possible alcohol content) \n--->\n\nConsider the residuals again. According to the data, a beer with 7.0% alcohol has between 160 and 231 calories. The predicted value is 201 calories. This variation means that the actual value was between 40 calories below and 30 calories above the predicted value. That isn't that far off. Some of the actual values differ by a large amount from the predicted value. This is due to variability in the response variable. The larger the residuals the less the model explains the variability in the response variable. There needs to be a way to calculate how well the model explains the variability in the response variable. This will be explored in the next section.\n\n\n### Checking Assumptions for the Regression Equation {#sec-assumption-validity-line}\n\nTwo assumptions must hold for the least squares regression equation to be valid: **randomness** and **linearity**.\n\n**Randomness**\n\nFor the linear regression model to be valid, the set of ordered pairs should be a random sample from the population of all such possible pairs.\n\nThe assumption of randomness ensures that the data are representative of the population and that the observed relationship is not the result of a systematic bias in how the data were collected. If the data are not obtained randomly—for example, if certain observations are more likely to be included than others—then the regression results may not generalize beyond the observed data.\n\nFor the beer data, do we have a random sample of alcohol content and calories? There is no guarantee that this was a random sample. The data was collected off of a website, and the website does not say how the data was obtained. However, it is a collection of most popular beers from large breweries, so it may be alright that it isn't a random sample.\n\n**Linearity**\n\nThe assumption of linearity means that the relationship between the explanatory variable and the response variable can be reasonably described by a straight line. In particular, for any given $x$-value, the average (mean) of the corresponding $y$-values should lie on, or very close to, the least squares regression line. This does not mean that all points fall on the line, but that the overall trend in the data follows a linear pattern.\n\nThe assumption of linearity is essential. If the relationship between the two variables is not linear, then a regression line will not fit the data well. To check linearity, we look at the scatter plot: a roughly straight-line pattern suggests the assumption is reasonable, while a curved pattern suggests it is not. We can also examine the so called residual-versus-fit plot. If the residuals are randomly scattered around the horizontal line $y = 0$ on this plot, the linearity assumption is likely valid. If the residuals show a curved pattern, then the assumption of linearity is likely violated.\n\nIs the assumption of linearity valid for the beer data? We examine two graphs to check this condition: the scatter plot of $y$ versus $x$ and the residual-versus-fit plot.\n\n@fig-Beer-point shows the scatter plot of calories versus alcohol content. This graph is also shown as part of the default output of the [Linear Regression]{.fun} function in Rguroo. This scatter plot looks fairly linear, so this condition appears to be satisfied.\n\n@fig-Beer-resvsfit shows the residual-versus-fit plot, which is also part of the [Linear Regression]{.fun} function output in Rguroo. The points on this plot are obtained by calculating the fitted values and the residuals for each data point. For each $x$-value, a predicted value for $y$ is computed using the equation of the least squares line; this predicted value is called the *fitted value* and is denoted by $\\hat{y}$. The residual is then found by subtracting the fitted value from the observed $y$-value: \n\n$$\n\\mbox{residual} = y - \\hat{y}.\n$$\n\nFor the beer data, the points in the residual-versus-fitted plot shown in @fig-Beer-resvsfit appear to be randomly scattered around the horizontal line at zero. There is no apparent curved pattern in the plot, suggesting that the linearity condition is satisfied.\n\n```{r AlcoholCalorieResvsFit, echo=FALSE}\n#| fig-alt: \"Residuals versus Fitted values plot looks random\"\n#| warning: FALSE\n#| label: fig-Beer-resvsfit\n#| fig-cap: \"Residuals versus Fitted Values Plot for Beer Data\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieResvsFit.png\")\n```\n\n\nRguroo calculates fitted values and residuals automatically. Continuing with the Rguroo instructions for fitting the regression equation to the beer data, shown [here](#Finding-the-Regression-Equation-in-Rguroo), selecting the checkbox [Predictions & Residuals]{.des} in the [Simple Linear Regression]{.dialog} dialog produces a table containing the fitted values (column labeled Predicted Value) and the residuals (column labeled Residual Value). The dialog box used for this step is shown in @fig-AlcoholCalorieResidualsDialog, and the Rguroo output, containing the fitted values and residuals for the first 20 cases of the beer data is given in @tbl-Beer-residuals-rguroo. It is these values that are plotted in @fig-Beer-resvsfit.\n\n```{r AlcoholCalorieResidualsDialog, echo=FALSE}\n#| fig-alt: \"Simple Regression Dialog for Showing How to Obtain the Fitted Values and Residuals\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieResidualsDialog\n#| fig-cap: \"Simple Regression Dialog for Showing How to Obtain the Fitted Values and Residuals\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_dialogs/Regression/AlcoholCalorieResidualsDialog1.png\")\n```\n\n```{r AlcoholCalorieResiduals, echo=FALSE}\n#| fig-alt: \"Fitted Values and Residuals for the first 20 cases of the Beer Data\"\n#| warning: FALSE\n#| label: tbl-Beer-residuals-rguroo\n#| fig-cap: \"Fitted Values and Residuals for the first 20 cases of the Beer Data\"\n#| out-width: \"90%\"\n\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieResiduals.png\")\n```\n\n\n\n```{r chapter-10-beer-residuals, echo=FALSE, eval=FALSE}\n#| tbl-alt: \"Residuals for Alcohol and Calorie Content in Beer\"\n#| label: tbl-Beer-residuals\n#| tbl-cap: \"Residuals for Alcohol and Calorie Content in Beer\"\nlm_out_beer<-lm(calories~alcohol, data=Beer) \nknitr::kable(residuals(lm_out_beer))\n```\n\n\n```{r Beer10-point-residuals, echo=FALSE, eval=FALSE}\n#| fig-alt: \"Residual plot of beer data, looks random\"\n#| warning: FALSE\n#| label: fig-Beer-residuals\n#| fig-cap: \"Residual Plot of Beer Data\"\ngf_point(residuals(lm_out_beer)~alcohol, data=Beer, title=\"Residuals for Calories in beer\", xlab=\"Alcohol Content\", ylab=\"Residuals for Number of Calories\") \n```\n\n### Checking Assumptions for Confidence Intervals and Tests {#sec-assumption-validity-inference} \n\nJust as with inference for means and proportions that you are already familiar with, we can construct confidence intervals and hypothesis tests for the slope and intercept of the regression line, as well as for predicted values $\\hat{y}$. These ideas are covered in @sec-inference-regression.\n\nTwo assumptions of constant variance and normality are primarily needed for the validity of inference in regression, **constant variance** and **normality**.\n\n**Constant Variance**\n\nThe assumption of constant variance is a requirement that the variance of the $y$-values should be the same across all $x$-values. \n\nTo check the constant-variance, we examine the residual-versus-fit plot: if the residuals are scattered with roughly the same vertical spread around the horizontal line $y = 0$ across all fitted-values, the assumption is reasonable. A funnel-shaped pattern suggests that unequal variances. \n\n@fig-inference-check shows four common patterns in a residual-versus-fitted plot. In panel (a), the residuals are evenly scattered above and below the horizontal line at 0 with roughly the same vertical spread across the fitted values, which is consistent with constant variance. Panels (b) and (c) show fan-shaped patterns, where the spread of the residuals changes as the fitted values change; these patterns suggest non-constant variance. Panel (d) shows a curved pattern in the residuals, which suggests that a straight-line model is not appropriate. In other words, it indicates possible nonlinearity, a violation of the linearity assumption discussed earlier.\n\n\n```{r inference-check, echo=FALSE}\n#| fig-alt: \"Various Patterns for Residual Versus Fitted Values\"\n#| warning: FALSE\n#| label: fig-inference-check\n#| fig-cap: \"Various Patterns for Residual Versus Fitted Values\"\n#| out-width: \"90%\"\n\nknitr::include_graphics(\"Rguroo_outputs/Regression/Inference_check.png\")\n```\n\n\n\nLooking again at the residual-versus-fit plot @fig-Beer-resvsfit for the beer data, the vertical spread of the residuals appears to be roughly the same across all fitted-values. There does not appear to be a funnel-shaped pattern, so this condition appears to be satisfied.\n\n**Normality**  \n\nThe normality assumption means that for any fixed value of $x$, the distribution of the corresponding $y$-values is approximately normal. In practice, this means the residuals at each $x$-value should be roughly symmetric and bell-shaped. \n\nTo check normality, we look at a histogram or a *normal probability plot* of the residuals. The histogram should appear bell-shaped, and in a normal probability plot the residuals should fall roughly along a straight line; pronounced curvature or outliers indicate that the normality assumption may not be satisfied.\n\nTo check this assumption for the beer data, we examine the normal probability plot of the residuals shown in @fig-Beer-QQ, which is also part of the [Linear Regression]{.fun} function output in Rguroo. In this plot, the residuals fall roughly along a straight line, so this condition appears to be satisfied. More specifically, all points lie within the confidence bands (shown as red dotted curves), and there is no pronounced curvature or outliers.\n\n```{r AlcoholCalorieQQ, echo=FALSE}\n#| fig-alt: \"Normal probability plots. The points seem to be roughly linear.\"\n#| warning: FALSE\n#| label: fig-Beer-QQ\n#| fig-cap: \"Normal Probability Plot for Beer Data\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieQQ.png\")\n```\n\n### Regression with Groups\n\nOne last thing that you may wonder is if imported beer has a different number of calories than domestic beer. The location (imported versus domestic) is a covariate, a third variable that may affects the calorie content. A covariate that is a categorical variable is referred to as a **factor**. You can create a scatter plot that  displays the data separately for each category of this covariate (factor). \n\nClick to expand the box below to see how to create a scatter plot of calories vs. alcohol content separated by location.\n\n:::: {#Creating-scatterplot-of-Calories-vs-Alcohol-location .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Creating scatter plot of Calories vs. Alcohol Content by Location\"}\n\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Plots** toolbox in Rguroo.  \n2. Open the [Create Plot]{.dpd} dropdown and select [scatter plot]{.fun}. This opens the scatter plot dialog.  \n3. In the scatter plot dialog, choose the [beer_data]{.data} dataset from the [Dataset]{.dpd} dropdown.  \n4. Choose the [alcohol]{.var} variable from the [Predictor (x)]{.dpd} dropdown.  \n5. Choose the [calories]{.var} variable from the [Response (y)]{.dpd} dropdown.\n6. Choose the [location]{.var} variable from the [Factor]{.dpd} dropdown.\n7. In the **superimpose** section of the dialog, select the checkbox [LS Line by Factor]{.des}.  \n8. **(Optional)** In the **Label** section of the dialog:  \n   - Enter [Calories versus Alcohol Content in Beer by Location]{.typein} in the [Title]{.des} textbox.  \n   - Enter [Alcohol Content]{.typein} in the [X-Axis]{.des} textbox.  \n   - Enter [Number of Calories]{.typein} in the [Y-Axis]{.des} textbox.  \n9. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to see a preview of the scatter plot.\n10. In the ![Save as](Rguroo_Icons/save_as.png) textbox, enter the name [AlcoholCalorieLocationScatter]{.typein} for the scatter plot.\nClick the button to save the scatter plot to your Rguroo account.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![scatter plot dialog showing settings for plotting alcohol content versus calories by location, including least square lines.\n](Rguroo_dialogs/Regression/scatterplot_dialog_factor.png){width=500px}\n\n:::\n\n::::\n\n\n```{r AlcoholCalorieLocationScatter, echo=FALSE}\n#| fig-alt: \"scatter plot of Calories versus Alcohol Content of Beer separated by Location\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieLocationScatter\n#| fig-cap: \"Calories versus Alcohol Content of Beer separated by Location\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieLocationScatter.svg\")\n```\n\n\n```{r Beer10a-point-lm, echo=FALSE, eval=FALSE}\n#| fig-alt: \"Scatter plot with linear regression line faccetted by domestic and import.\"\n#| warning: FALSE\n#| label: fig-Beer-point-lm\n#| fig-cap: \"Calories versus Alcohol Content of Beer separated by Location\"\ngf_point(calories~alcohol, data=Beer, title=\"Calories versus Alcohol Content of Beer separated by Location\", color=~location, xlab=\"Alcohol Content\", ylab=\"Number of calories\") |>\n  gf_lm() \n```\n\n@fig-AlcoholCalorieLocationScatter shows the scatter plot of calories versus alcohol content separated by location (imported versus domestic). The least squares lines for each location are also shown. Looking at the scatter plot, there doesn't appear to be an affect from domestic or import. This is what is nice about scatter plots, You can visually see a possible relationships.\n\n### Homework for Regression Section\n\n**For each problem, state the variables. The datasets in this section are used in the homework for sections 10.2 and 10.3 also.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected and are in @tbl-Metacarpal (\"Prediction of height\" 2013). \nCreate a scatter plot and find a regression equation between the height of a person and the length of their metacarpal. Then use the regression equation to find the height of a person for a metacarpal length of 44 mm and for a metacarpal length of 55 mm. Which height that you calculated do you think is closer to the true height of the person? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n**Code book for Dataset Metacarpal is below @tbl-Metacarpal.**\n\n</div>\n\n2.  @tbl-House contains the value of the house and the amount of rental income in a year that the house brings in (\"Capital and rental\" 2013). Create a scatter plot and find a regression equation between house value and rental income. Then use the regression equation to find the rental income of a house worth \\$230,000 and for a house worth \\$400,000. Which rental income that you calculated do you think is closer to the true rental income? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n**Code book for Dataset House is below @tbl-House.**\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at\" 2013) and the fertility rate per woman in the country (\"Fertility rate\" 2013). The Dataset for countries for the year 2011 are in @tbl-Fertility. Create a scatter plot of the Dataset and find a linear regression equation between fertility rate and life expectancy in 2011. Then use the regression equation to find the life expectancy for a country that has a fertility rate of 2.7 and for a country with fertility rate of 8.1. Which life expectancy that you calculated do you think is closer to the true life expectancy? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The Dataset for the countries where this information is available in @tbl-Fert_prenatal. Create a scatter plot of the Dataset and find a regression equation between percentage spent on health expenditure and the percentage of women receiving prenatal care. Then use the regression equation to find the percent of women receiving prenatal care for a country that spends 5.0% of GDP on health expenditure and for a country that spends 12.0% of GDP. Which prenatal care percentage that you calculated do you think is closer to the true percentage? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n5.  The height and weight of baseball players are in @tbl-Baseball (\"MLB heightsweights\" 2013). Create a scatter plot and find a regression equation between height and weight of baseball players. Then use the regression equation to find the weight of a baseball player that is 75 inches tall and for a baseball player that is 68 inches tall. Which weight that you calculated do you think is closer to the true weight? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n</div>\n\n```{r chapter-10-baseball-data, echo=FALSE}\n#| tbl-alt: \"Head of Heights and Weights of Baseball Players Dataset\"\n#| label: tbl-Baseball\n#| tbl-cap: \"Heights and Weights of Baseball Players\"\nBaseball <- read.csv( \"https://krkozak.github.io/MAT160/baseball.csv\") \nknitr::kable(head(Baseball))\n```\n\n\n::: {#code-book-baseball .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Baseball\n\n**Description**\n\nThe heights and weights of MLB players.\n\nFormat\n\nThis Dataset contains the following columns:\n\nPlayer: Player in the sample\n\nheight: height of baseball player (inches)\n\nweight: weight of baseball player (pounds)\n\n[Source](http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_MLB_HeightsWeights) MLB heightsweights. (2013, November 16).\n\nReferences SOCR Dataset of MLB Heights Weights from UCLA.\n\n:::\n\n6.  Different species have different body weights and brain weights are in @tbl-Body. (\"Brain2bodyweight\" 2013). Create a scatter plot and find a regression equation between body weights and brain weights. Then use the regression equation to find the brain weight for a species that has a body weight of 62 kg and for a species that has a body weight of 180,000 kg. Which brain weight that you calculated do you think is closer to the true brain weight? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n</div>\n\n```{r Chapter-10-Body-data, echo=FALSE}\n#| tbl-alt: \"Head of Body Weights and Brain Weights of Species\"\n#| label: tbl-Body\n#| tbl-cap: \"Body Weights and Brain Weights of Species\"\nBody <- read.csv( \"https://krkozak.github.io/MAT160/body.csv\") \nknitr::kable(head(Body))\n```\n\n::: {#code-book-body .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Body\n\n**Description**\n\nThe body weight, brain weight, and brain/body proportion of different species of animals.\n\nFormat\n\nThis Dataset contains the following columns:\n\nspecies: species of animal\n\nbodyweight: the body weight of the species (kg)\n\nbrainweight: the brain weight of the species (kg)\n\nbrainbodyproportion: the ratio of brain weight to body weight of the species\n\nSource Brain2bodyweight. (2013, November 16). Retrieved from http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Brain2BodyWeight\n\nReferences SOCR Data of species body weights and brain weights from UCLA.\n\n:::\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs\" 2013.) The first six rows of the dataset are shown in @tbl-Hotdog. Create a scatter plot and find a regression equation between amount of calories and amount of sodium. Then use the regression equation to find the amount of sodium a hot dog has if it is 170 calories and if it is 120 calories. Which sodium level that you calculated do you think is closer to the true sodium level? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n\n</div>\n\n```{r Chapter10-Hotdog-data, echo=FALSE}\n#| tbl-alt: \"Head of Body Weights and Brain Weights of Species\"\n#| label: tbl-Hotdog\n#| tbl-cap: \"Hotdog Dataset\"\nBody <- read.csv( \"https://krkozak.github.io/MAT160/hotdog_beef_poultry.csv\") \nknitr::kable(head(Hotdog))\n```\n\n\n::: {#code-book-hotdogs .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset hotdogs\n\n**Description**\n\nThis dataset contains nutritional information for a sample of commercially available hot dogs. The data include calorie counts and sodium content for each hot dog, along with a categorical classification of the hot dog type. The dataset is commonly used to illustrate comparisons of quantitative variables across groups.\n\nVariables  \n[type]{.var}  \nCategorical variable indicating the type of hot dog. Typical categories include Beef, Meat, and Poultry.\n\n[calories]{.var}  \nQuantitative variable giving the number of calories per hot dog.\n\n[sodium]{.var}  \nQuantitative variable giving the sodium content per hot dog, measured in milligrams.\n\nSource  \nThe dataset is widely used in introductory statistics textbooks and examples and is often attributed to a Consumer Reports–style nutritional analysis of hot dog brands.\n:::\n\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in @tbl-Agriculture (\"OECD economic development\" 2013). Create a scatter plot and find a regression equation between percent of labor force in agriculture and per capita income. Then use the regression equation to find the per capita income in a country that has 21 percent of labor in agriculture and in a country that has 2 percent of labor in agriculture. Which per capita income that you calculated do you think is closer to the true income? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n</div>\n\n\n```{r chapter-10-agricultue-data, echo=FALSE}\n#| tbl-alt: \"Head of Percent of Labor in Agriculture and Per Capita Income for European Countries\"\n#| label: tbl-Agriculture\n#| tbl-cap: \"Percent of Labor in Agriculture and Per Capita Income for European Countries\"\nAgriculture <- read.csv( \"https://krkozak.github.io/MAT160/agriculture.csv\") \nknitr::kable(head(Agriculture))\n```\n\n::: {#code-book-agriculture .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Agriculture**\n\n**Description**\n\nThe per capita income and percent in different industries in European countries\n\nFormat\n\nThis Dataset contains the following columns:\n\ncountry: country in Europe\n\npercapita: per captia income\n\nagriculture: percentage of workforce in agriculture\n\nindustry: percentage of workforce in industry\n\nservices: percentage of workforce in services\n\n[Source](http://lib.stat.cmu.edu/DASL/Datafiles/oecdat.html) OECD economic development. (2013, December 04).\n\nReferences Data And Story Library\n\n:::\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are in the dataset [cancer_1]{.data} (\"Smoking and cancer\" 2013). The first six rows of the data is shown in @tbl-Cancerbladder. Create a scatter plot and find a regression equation between number of cigarettes smoked and number of deaths from bladder cancer. Then use the regression equation to find the number of deaths from bladder cancer when the cigarette sales were 20 per capita and when the cigarette sales were 6 per capita. Which number of deaths that you calculated do you think is closer to the true number? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\n```{r chapter-10-cancer-data, echo=FALSE}\n#| tbl-alt: \"Head of Number of Cigarettes and Number of Bladder Cancer Deaths\"\n#| label: tbl-Cancerbladder\n#| tbl-cap: \"Number of Cigarettes and Number of Bladder Cancer Deaths\"\nCancer <- read.csv( \"https://krkozak.github.io/MAT160/cancer_1.csv\") \nknitr::kable(head(Cancer))\n```\n\n::: {#code-book-cancer .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Cancer\n\n**Description** This Dataset contains the number of cigarette sales (per Capita), number of cancer Deaths (per 100 Thousand) from bladder, lung, kidney, and leukemia.\n\nFormat\n\nThis Dataset contains the following columns:\n\nstate: state in US\n\ncig: the number of cigarette sales (per capita)\n\nbladder: number of deaths per 100 thousand from bladder cancer\n\nlung: number of deaths per 100 thousand from lung cancer\n\nkidney: number of deaths per 100 thousand from kidney cancer\n\nleukemia: number of deaths per 100 thousand from leukemia\n\n[Source](http://lib.stat.cmu.edu/DASL/Datafiles/cigcancerdat.html) Smoking and cancer. (2013, December 04).\n\nReferences Data And Story Library\n\n:::\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and the first six rows are shown in @tbl-Cars (\"us auto mileage,\" 2019). Create a scatter plot and find a regression equation between weight of cars and mileage. Then use the regression equation to find the mileage on a car that weighs 3800 pounds and on a car that weighs 2000 pounds. Which mileage that you calculated do you think is closer to the true mileage? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n</div>\n\n```{r chapter-10-cars-data, echo=FALSE}\n#| tbl-alt: \"Head of Weights and Mileages of Carss\"\n#| label: tbl-Cars\n#| tbl-cap: \"Weights and Mileages of Cars\"\nCars<- read.csv( \"https://krkozak.github.io/MAT160/cars.csv\") \nknitr::kable(head(Cars))\n```\n\n::: {#code-book-cars .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Cars\n\n**Description** \n\nVariation in gasoline mileage among makes and models of automobiles is influenced substantially by the weight and horsepower of the vehicles. When miles per gallon and horsepower are transformed to logarithms, the linearity of the regression is improved. A negative second order term is required to fit the logarithmic mileage to weight relation. If the logged variables are standardized, the coefficients of the first order terms indicate the standard units change in log mileage per one standard unit change in the predictor variable at the (logarithmic) mean. This change is constant in the case of mileage to horsepower, but not for mileage to weight. The coefficient of the second order weight term indicates the change in standardized slope associated with a one standard deviation increase in the logarithm of weight.\n\nFormat\n\nThis Dataset contains the following columns:\n\nmake: the type of car\n\nvol: cubic feet of cab space\n\nhp: engine horsepower\n\nnpg: the average mileage of the car\n\nsp: top speed (mph)\n\nwt: the weight of the car (100 pounds)\n\nSource (n.d.). Retrieved July 21, 2019, from https://www3.nd.edu/\\~busiforc/handouts/Data and Stories/regression/us auto mileage/usautomileage.html\n\nReferences R.M. Heavenrich, J.D. Murrell, and K.H. Hellman, Light Duty Automotive Technology and Fuel Economy Trends Through 1991, U.S. Environmental Protection Agency, 1991 (EPA/AA/CTAB/91-02).\n\n:::\n\n## Correlation \n\n<!-- Rewrote this section to explain correlation more and how to find it in Rguroo. Also have a smooth transition to R^2 -->\n\nA correlation exists between two variables when the values of one variable are associated with the values of the other variable. Correlation is a word used in everyday life, and many people think they understand what it means. What it really means, when stated as a number, is a measure of how strong the linear relationship is between two variables. This measure is called the **correlation coefficient**, or **correlation** for short. It is also called the **Pearson correlation coefficient** after Karl Pearson who developed it. There are many types of patterns (relationships) between variables that one can see in data. Common types of patterns are linear, exponential, logarithmic, or periodic. To see these patterns, you can draw a scatter plot of the data. In this chapter, and generally in this course, we mostly deal with linear relationships.\n\n### Interpretation of the correlation coefficient\n\nThe correlation coefficient is a number between −1 and 1 and is usually denoted by the letter $r$. A value of $r = 1$ indicates a perfect positive linear relationship, and a value of $r = -1$ indicates a perfect negative linear relationship. A perfect linear relationship means that all of the data points lie exactly on a straight line.\n\nThe strength of the linear relationship depends on how close $r$ is to 1 or −1. Values of $r$ close to these extremes indicate a strong linear relationship, while values closer to 0 indicate a weaker linear relationship. A correlation of $r = 0$ means there is no linear relationship between the two variables.\n\nThe sign of $r$ describes the direction of the relationship. A positive correlation means that as one variable increases, the other variable tends to increase. A negative correlation means that as one variable increases, the other variable tends to decrease.\n\n<!--\n$r$ is always between $-1$ and 1. $r$ = $-1$ means there is a perfect negative linear correlation and $r$ = 1 means there is a perfect positive correlation. The closer $r$ is to 1 or $-1$, the stronger the correlation. The closer $r$ is to 0, the weaker the correlation. CAREFUL: $r$ = 0 does not mean there is no correlation. It just means there is **no linear correlation**. There might be a very strong curved pattern.\n-->\n\n::: {#exm-correlation-interpretation}\n## Calculating the Linear Correlation Coefficient, $r$\n\nHow strong is the positive relationship between alcohol content and the number of calories in a 12-ounce beer? To answer this question, compute the correlation between alcohol content and calories using the [beer]{.data} dataset (“Calories in Beer,” 2011). The first six rows of this dataset are shown in @tbl-Beer. Use Rguroo to find the correlation coefficient and then interpret its value.\n\n:::\n\n\n** Solution** \n\nYou can obtain the correlation coefficient, $r$, in Rguroo from the output of the [Linear Regression]{.fun} function. To obtain this value for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo).\n\nFor these data the correlation coefficient between alcohol content and calories is 0.9036. This value appears in the _Data and Model Summary_ table of the regression function output in the row labeled [Pearson Correlation (r)]{.des}; see @tbl-Beer-lm-model, and it indicates a strong positive linear relationship between alcohol content and calories, since the value of $r$ is close to 1. Also, since $r$ is positive, it means that as alcohol content increases, the number of calories tends to increase as well.\n\n<!--\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFrom example 10.2.1, $R^2=0.8164$. The correlation coefficient = $r=\\sqrt{r^2}=\\sqrt{0.8164}=0.9035486$, or use this command in r\n\n```{r}\ncor(calories~alcohol, data=Beer)\n```\n\nThe scatter graph went up from left to right, so the correlation coefficient is positive. Since 0.90 is close to 1, then that means there is a fairly strong positive correlation.\n\n-->\n\n\n\n<!-- However, it doesn't give you a strong indication of how well the relationship explains the variability in the response variable, and it doesn't work for more than two variables. There is a way to look at how much of the relationship explains the variability in the response variable.\n-->\n\n### Coefficient of Determination, $R^2$\n\nCorrelation is related to another measure that explains how much of the variability in the response variable is explained by the explanatory variable. The variability in a response variable can be due to many factors. Some of the variability is explained by the explanatory variable and some is due to other factors. For example, in the beer example, some of the variability in calories is explained by alcohol content and some is due to other factors, such as other ingredients in the beer. There is a way to measure how much of the variability in the response variable is explained by the explanatory variable. This measure is called the **coefficient of determination**, denoted by $R^2$ (read R-squared), and its value is the square of the correlation.\n\n<!-- There is some variability in the response variable values, such as calories. Some of the variation in calories is due to alcohol content and some is due to other factors. How much of the variation in the calories is due to alcohol content?\n-->\n\nAs an example, using the beer data, we want to understand how much of the variation in calories is explained by alcohol content and how much is due to other factors, such as ingredients. For instance, two beers can have the same alcohol content but different numbers of calories because they contain different ingredients. A linear regression of calories on alcohol content explains the part of the variation in calories that is associated with alcohol content. The remaining variation is due to other factors and random differences between beers, and is not explained by the regression. Together, the explained and unexplained parts account for all of the variability in calories:\n\n(total variation) = (explained variation) + (unexplained variation)\n\nThe proportion of the variation that is explained by the model is $R^2=\\frac{\\text{explained variation}}{\\text{total variation}}$.\n\nThis is known as the **coefficient of determination**.\n\n:::{#exm-coefficient-determination}\n## Calculating the Coefficient of Determination, $R^2$\n\nHow well does the alcohol content of a beer explain the variability in the number of calories in 12-ounce beer? To determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer.\n:::\n\n**Solution**\n\nYou can obtain the coefficient of determination, $R^2$, in Rguroo from the output of the [Linear Regression]{.fun} function. To obtain the coefficient of determination for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo).\n\nFor these data, the coefficient of determination between alcohol content and calories is 0.8164. This value appears in the _Data and Model Summary_ table of the regression function output in the row labeled [Coefficient of Determination (R-squared)]{.des}; see @tbl-Beer-lm-model. This value indicates that 81.64% of the variability in calories is explained by alcohol content, while the remaining 18.36% is due to other factors.\n\nA high coefficient of determination (for example, above 0.8) means that only a small portion of the variability is unexplained. In this situation, alcohol content alone explains most of the variability in calories, so there may be little need to include additional explanatory variables to improve the model.\n\n<!--\n\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFirst find and name the linear model, how about lm_out_beer, so you can refer to it. Then use the command\n\n```{r chapter-10-beer-lm, echo=TRUE, eval=FALSE}\nlm_out_beer<-lm(calories~alcohol, data=Beer) #creates the linear model and calls it lm_out_beer \nrsquared(lm_out_beer) #finds the rsquared of the linear model created.\n```\n\nThe $R^2=0.8164$. Thus, 81.64% of the variation in calories is explained to the linear relationship between alcohol content and calories. The other 18.36% of the variation is due to other factors. \n\nThis is all you have to do to find how much of the variability in the response variable is explained by the linear model.\n\n-->\n\nThere is a relationship between correlation coefficient $r$ and the coefficient of determination $R^2$, namely $r = \\pm\\sqrt{R^2}$.\nThe question is which sign, plus ($+$) or minus ($-$), should be used. If the relationship is positive (that is, the slope of the regression line is positive), use the $+$ sign. If the relationship is negative (the slope is negative), use the $-$ sign. In other words, assign to $r$ the same sign as the slope of the linear regression line.\n\n<!--\nYou can also use this command and r will give you the correct sign.\n\ncor(respose_variable\\~explanatory_variable, data=Data_Frame)\n\nThe **linear correlation coefficient** is a number that describes the strength of the linear relationship between the two variables. It is also called the Pearson correlation coefficient after Karl Pearson who developed it.\n\n-->\n\n### Causation\n\nOne common mistake people make is to assume that because there is a correlation between two variables, then one variable causes the other. This is usually not the case. That would be like saying the amount of alcohol in the beer causes it to have a certain number of calories. However, fermentation of sugars is what causes the alcohol content. The more sugars you have, the more alcohol can be made, and the more sugar, the higher the calories. It is actually the amount of sugar that causes both. Do not confuse the idea of correlation with the concept of causation. Just because two variables are correlated does not mean one causes the other to happen. However, the new theory is showing that if you have a relationship between two variables and a strong correlation, and you can show that there are no other variables that could explain the change, then you can show causation. This is how doctors have shown that smoking causes kidney cancer. Just realize that proving that one caused the other is a difficult process, and causation should not be just assumed.\n\n::: {#exm-correlation-causation}\n## Correlation Versus Causation Examples\n\n<!--We probably should reconsider these two examples.-->\n\na.  A study showed a strong linear correlation between per capita beer consumption and teacher's salaries. Does giving a teacher a raise cause people to buy more beer? Does buying more beer cause teachers to get a raise?\n\nThere is probably some other factor causing both of them to increase at the same time. Think about this: In a town where people have little extra money, they won't have money for beer and they won't give teachers raises. In another town where people have more extra money to spend it will be easier for them to buy more beer and they would be more willing to give teachers raises.\n\nb.  A study shows that there is a correlation between people who have had a root canal and those that have cancer. Does that mean having a root canal causes cancer?\n\n:::\n\nJust because there is positive correlation doesn't mean that one caused the other. It turns out that there is a positive correlation between eating carrots and cancer, but that doesn't mean that eating carrots causes cancer. In other words, there are lots of relationships you can find between two variables, but that doesn't mean that one caused the other.\n\nRemember a correlation only means a pattern exists. It does not mean that one variable causes the other variable to change.\n\n### Homework for Correlation Section\n\n**For each problem, state the random variables.The Dataset in this section are in section 10.1 and will be used in section 10.3.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected. The data are in the [height_vs_metacarp]{.data} dataset, and the first six rows of the data are shown in @tbl-Metacarpal (\"Prediction of height,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n\n**Code book for Dataset Metacarpal is below** @tbl-Metacarpal.\n\n</div>\n\n2.  @tbl-House contains the first six values of the house and the amount of rental income in a year that the house brings in (\"Capital and rental,\" 2013). Use the [house]{.data} dataset to find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n\n**Code book for Dataset House is below @tbl-House.**\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at,\" 2013) and the fertility rate per woman in the country (\"Fertility rate,\" 2013). The first siz rows of the [Life_exp_fert_rate]{.data} dataset for countries for the year 2011 are in @tbl-Fertility. Use the dataset to find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The data for the countries where this information is available is in the  [fertility_prenatal]{.data} dataset and the first six rows of the data are given in @tbl-Fert_prenatal. Find the coefficient of determination and the correlation coefficient between the percentage spent on health expenditure and the percentage of women receiving prenatal care, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n5.  The height and weight of baseball players are in the [baseball]{.data} dataset and the first six rows of the data are shown in @tbl-Baseball (\"MLB heightsweights,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n**Code book for Dataset Baseball is below @tbl-Baseball.**\n\n</div>\n\n6.  Different species have different body weights and brain weights. The dataset [body]{.data} contains data about these two variables, and @tbl-Body shows the first six rows of the dataset (\"Brain2bodyweight,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n**Code book for Dataset Body is below @tbl-Body.**\n\n</div>\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs,\" 2013). The data are in [hotdog]{.data} dataset with the first six rows shown in @tbl-Hotdog. Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n**Code book for Dataset Hotdog is below @tbl-Hotdog.**\n\n</div>\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in the dataset [agriculture]{.data}. The first six rows are shon in  @tbl-Agriculture (\"OECD economic development,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n**Code book for Dataset Agriculture is @tbl-Agriculture.**\n\n</div>\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are given in the dataset [cancer_1]{.data} with the first six rows showing in  @tbl-Cancerbladder (\"Smoking and cancer,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\nThe codebook for the dataset cancer is given [here](#code-book-cancer)\n\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and are in [cars]{.data} dataset. The first six rows of the data are shown in @tbl-Cars (\"us auto mileage,\" 2019). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n**Code book for Dataset Cars is below @tbl-Cars.**\n\n</div>\n\n11. There is a correlation between police expenditure and crime rate. Does this mean that spending more money on police causes the crime rate to decrease? Explain your answer.\n\n12. There is a correlation between tobacco sales and alcohol sales. Does that mean that using tobacco causes a person to also drink alcohol? Explain your answer.\n\n13. There is a correlation between the average temperature in a location and the mortality rate from breast cancer. Does that mean that higher temperatures cause more women to die of breast cancer? Explain your answer.\n\n14. There is a correlation between the length of time a tableware company polishes a dish and the price of the dish. Does that mean that the time a plate is polished determines the price of the dish? Explain your answer.\n\n## Inference for Regression and Correlation {#sec-inference-regression}\n\nThe idea behind regression is to find an equation that relates the response variable to the explanatory variables, and then use that equation to predict values of the response variable from values of the explanatory variables. But how do you know how good that estimate is?\n\nWhen we use a regression equation to make a prediction, the predicted value is only a single number. In practice, however, there is almost always some uncertainty in that prediction. Even if we knew the true relationship between the variables, individual observations would still vary around that relationship due to natural randomness and factors not included in the model.\n\nBecause of this variability, it is usually more informative to give a range of plausible values for the response variable rather than a single predicted value. A prediction interval provides such a range. It gives an interval of values that is likely to contain the response value for a new observation with specified explanatory variable values, along with a stated level of confidence.\n\n<!-- I am removing computation of standard error since students do not use this for anything in their computations. We will focus on obtaining prediction intervals. \n First you need a measure of the variability in the estimate, called the standard error of the estimate. The definition of the **standard error of the estimate** is how much error is in the estimate from the regression equation.\n\n**Standard Error of the Estimate** formula $S_e=\\sum{(\\hat{y}-y)^2}$\n\nThis formula is hard to work with but luckily r Studio will calculate it for you. In fact the command has already been used, so this information is already found. The command is\n\nsummary(lm_out) #lm_out is the name you gave the linear model\n\n### Example: Finding the Standard Error of the Estimate\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer? To determine if there is a sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019), in @tbl-Beer. Find the standard error of the estimate.\n\n**Code book for Dataset Beer is below @tbl-Beer.**\n\n#### Solution\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFirst save the linear model with a name like lm_out_beer. Then use summary(lm_out_beer) to find the standard error of the estimate.\n\n```{r chapter-10-beer-lm-out}\nlm_out_beer=lm(calories~alcohol, data=Beer) \nsummary(lm_out_beer)\n```\n\nThe standard error of the estimate is the residual standard error in the output. So the standard error of the estimate for the number of calories in a beer related to alcohol content is $S_e=17.62$\n\n-->\n\n### Prediction Interval\n\nUsing the regression equation you can predict the number of calories from the alcohol content. However, you only find one value. The problem is that beers vary a bit in calories even if they have the same alcohol content. It would be nice to have a range instead of a single value. The range is called a prediction interval.\n\n### Prediction Interval for an Individual $y$\n\nGiven the fixed value $x$, a prediction interval for the response at $x$ is $\\hat{y}\\pm E$ where $\\hat{y}$ is the predicted value from the regression equation and $E$ is the margin of error for the prediction.\n\nRguroo will calculate the prediction interval for you in the [Linear Regression]{.fun} function. You just have to give it the value of $x$ that you want to predict for, and tell it you want a prediction interval.\n\n### Example: Find the Prediction Interval\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer?\nTo determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer. Find a 95% prediction interval for the number of calories when the alcohol content is 7.0%.\n\n#### Solution\n\nTo obtain the prediction interval for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo). Additionally, in the [linear Regression]{.fun} dialog box, enter the value of alcohol content (0.07) in the textbox labeled [Predict at new x value(s)]{.des}. Then click the tab labeled [Prediction Interval]{.des} and select the checkboxes labeled [Prediction Interval]{.des}. These steps are shown in @fig-AlcoholCalorieRegress_pred_interval. \n\n```{r AlcoholCalorieRegress_pred_interval, echo=FALSE}\n#| fig-alt: \"Rguroo dialog for obtaining prediction interval for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_pred_interval\n#| fig-cap: \"Rguroo dialog for obtaining prediction interval for calories from alcohol content\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_pred_interval.png\")\n```\n\nThe output containing the prediction interval is shown in @fig-Beer-pred-interval.\n\n```{r Beer-pred-interval, echo=FALSE}\n#| fig-alt: \"Rguroo output showing prediction interval for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-Beer-pred-interval\n#| fig-cap: \"Rguroo output showing prediction interval for calories from alcohol content\"\n#| out-width: \"85%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/Beer-pred-interval.png\")  \n```\n\n<!---\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nComputing the prediction interval using r Studio\n\n```{r chapter-10-beer-predict, eval = FALSE, echo=FALSE}\npredict(lm_out_beer, newdata=list(alcohol=0.07), interval = \"prediction\", level=0.95) \n```\n\n--->\n\nThe value 201.592 is the model’s predicted number of calories for a beer with 7.0% alcohol. The prediction interval is shown in the columns labeled _Lower Pred Limit (2.5%)_ and _Upper Pred Limit (97.5%)_. This means we can be 95% confident that the actual number of calories for a beer with 7.0% alcohol lies between 166.7 and 236.5. This range is called a 95% prediction interval.\n\nYou can obtain prediction intervals for other alcohol contents by entering different values in the textbox labeled [Predict at new x value(s)]{.des} in the [Linear Regression]{.fun} dialog box. You can also change the confidence level using the textbox labeled [Confidence Level]{.des} in the [Confidence Interval]{.des} tab.\n\n### Hypothesis Test for Correlation or Slope:\n\nHow do we decide whether there is really a correlation or a linear relationship between two variables? Can we test whether such a relationship exists? The answer is yes. We can test for correlation, or we can test whether the slope of the regression line is zero.\n\nThese two tests are equivalent. If there is a correlation between the variables, then the slope of the regression line is not zero. Likewise, if the slope of the regression line is not zero, then there is a correlation between the variables. For this reason, testing for correlation and testing for slope lead to the same conclusion.\n\nThe steps for performing a hypothesis test for correlation are given below. You can use these steps to test for correlation or to test whether the slope is zero.\n\n1.  State the variables in words.\n\n  $x$ = explanatory variable\n\n  $y$ = response variable\n\n2.  State the null and alternative hypotheses and the level of significance\n\n$H_o: \\text{there is not a correlation}$\n\n$H_a: \\text{there is a correlation}$\n\nOr equivalently\n\n$H_o: \\text{the slope is zero}$\n\n$H_a: \\text{the slope is not zero}$\n\nAlso, state $\\alpha$, the significance level for your test.\n\n3.  State and check the conditions for the hypothesis test, as explained in @sec-assumption-validity-line (Assumptions for Validity of the Regression Equation and Line) and @sec-assumption-validity-inference (Assumptions for Validity of Inference).\n\n4.  Find the test statistic and p-value\n\nThis will be calculated by Rguroo.\n\n5.  Conclusion\n\nThis is where you write reject $H_o$ or fail to reject $H_o$. The rule is: if the p-value $<\\alpha$, then reject $H_o$. If the p-value $\\ge \\alpha$, then fail to reject $H_o$\n\n6.  Interpretation\n\nThis is where you interpret in real world terms the conclusion to the test. The conclusion for a hypothesis test is that you either have enough evidence to support $H_a$, or you do not have enough evidence to support $H_a$.\n\n### Example: Testing the Claim of a Linear Correlation\n\nIs there a linear relationship, or correlation, between the alcohol content and the number of calories in 12-ounce beer? To determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer. Test at the 5% level.\n\n#### Solution\n\n1.  State the random variables in words.\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\n2.  State the null and alternative hypotheses and the level of significance\n\n$H_o: \\text{there is not a correlation}$\n\n$H_a: \\text{there is a correlation}$\n\nlevel of significance $\\alpha=0.05$\n\n3.  State and check the conditions for the hypothesis test\n\nThe conditions for the hypothesis test were already checked in [Example: Find the Equation of the Regression Line]\n\n4.  Find the test statistic and p-value\n\nTo obtain the test statistic and p-value, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo). Additionally, in the [linear Regression]{.fun} dialog box, under the [Test of Association]{.des} tab, check the box labeled [Slope]{.des}, and under the **method** section select [Theoretical t-statistic]{.des}. These steps are shown in @fig-AlcoholCalorieRegress_test. The default value for the significance level is 0.05, so you do not need to change that value. However, if you want to change it, you can do so in the textbox labeled [Significance Level]{.des}.\n\n```{r AlcoholCalorieRegress_test, echo=FALSE}\n#| fig-alt: \"Rguroo dialog for testing slope for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_test\n#| fig-cap: \"Rguroo dialog for testing slope for calories from alcohol content\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_test.png\")\n\n```\n\nThe output containing the result of the test shown in @fig-AlcoholCalorieRegress_test_out.\n\n```{r AlcoholCalorieRegress_test_out, echo=FALSE}\n#| fig-alt: \"Result of Rguroo hypothesis test for slope for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_test_out\n#| fig-cap: \"AlcoholCalorieRegress_test_out\"\n#| out-width: \"85%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/AlcoholCalorieRegress_test_out.png\")\n  \n```\n\n```{r chapter-10-beer-test, eval=FALSE, echo=FALSE}\nlm_out_beer<-lm(calories~alcohol, data=Beer) \nsummary(lm_out_beer)\n```\n\nThe test statistic is the t value in the column labeled _Obs t Stat_. In this case the t-statistic is 31.634, and the p-value id $8.84X10^{-85}$.\n\n5.  Conclusion\n\nReject $H_o$ since the p-value is less than 0.05.\n\n6.  Interpretation\n\nThere is enough evidence to show that there is a correlation between alcohol content and number of calories in a 12-ounce bottle of beer.\n\n### Homework for Inference for Regression and Correlation Section\n\n**For each problem, state the random variables. The Dataset in this section are in the homework for section 10.1 and were also used in section 10.2.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected. The data are in the [height_vs_metacarp]{.data} dataset, and the first six rows of the data are shown in @tbl-Metacarpal (\"Prediction of height,\" 2013).\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n**Code book for Dataset Metacarpal is below @tbl-Metacarpal.**\n\na.  Compute a 99% prediction interval for height of a person with a metacarpal length of 44 mm.\nb.  Test at the 1% level for a correlation or linear relationship between length of metacarpal bone 1 and height of a person.\n\n</div>\n\n2.  @tbl-House contains the first six values of the house and the amount of rental income in a year that the house brings in (\"Capital and rental,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n**Code book for Dataset House is below @tbl-House.**\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the rental income on a house worth \\\\\\$230,000.\nb.  Test at the 5% level for a correlation or linear relationship between house value and rental amount.\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at,\" 2013) and the fertility rate per woman in the country (\"Fertility rate,\" 2013). The first siz rows of the [Life_exp_fert_rate]{.data} dataset for countries for the year 2011 are in @tbl-Fertility. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 99% prediction interval for the life expectancy for a country that has a fertility rate of 2.7.\nb.  Test at the 1% level for a correlation or linear relationship between fertility rate and life expectancy.\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The data for the countries where this information is available is in the  [fertility_prenatal]{.data} dataset and the first six rows of the data are given in @tbl-Fert_prenatal. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the percentage of woman receiving prenatal care for a country that spends 5.0 % of GDP on health expenditure.\nb.  Test at the 5% level for a correlation or linear relationship between percentage spent on health expenditure and the percentage of women receiving prenatal care.\n\n5.  The height and weight of baseball players are in the [baseball]{.data} dataset and the first six rows of the data are shown in @tbl-Baseball (\"MLB heightsweights,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n**Code book for Dataset Baseball is below @tbl-Baseball.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the weight of a baseball player that is 75 inches tall.\nb.  Test at the 5% level for a correlation or linear relationship between height and weight of baseball players.\n\n\n6.  Different species have different body weights and brain weights. The dataset [body]{.data} contains data about these two variables, and @tbl-Body shows the first six rows of the dataset (\"Brain2bodyweight,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n**Code book for Dataset Body is below @tbl-Body.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 99% prediction interval for the brain weight for a species that has a body weight of 62 kg.\nb.  Test at the 1% level for a correlation or linear relationship between body weights and brain weights.\n\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs,\" 2013). The data are in [hotdog]{.data} dataset with the first six rows shown in @tbl-Hotdog. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n**Code book for Dataset Hotdog is below @tbl-Hotdog.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the amount of sodium a beef hot dog has if it is 170 calories.\nb.  Test at the 5% level for a correlation or linear relationship between amount of calories and amount of sodium.\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in the dataset [agriculture]{.data}. The first six rows are shon in  @tbl-Agriculture (\"OECD economic development,\" 2013).\n\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n**Code book for Dataset Agriculture is @tbl-Agriculture.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate.-->\nb.  Compute a 90% prediction interval for the per capita income in a country that has 21 percent of labor in agriculture.\nc.  Test at the 5% level for a correlation or linear relationship between percent of labor force in agriculture and per capita income.\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are given in teh dataset [cancer_1]{.data} with the first six rows showing in  @tbl-Cancerbladder (\"Smoking and cancer,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\nThe codebook for the dataset cancer is given [here](#code-book-cancer)\n\n\n<!-- a.  Find the standard error of the estimate.-->\na.  Compute a 99% prediction interval for the number of deaths from bladder cancer when the cigarette sales were 20 per capita.\nb.  Test at the 1% level for a correlation or linear relationship between cigarette smoking and deaths of bladder cancer.\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and are in [cars]{.data} dataset. The first six rows of the data are shown in @tbl-Cars (\"us auto mileage,\" 2019).\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n**Code book for Dataset Cars is below @tbl-Cars.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the mileage on a car that weighs 3800 pounds.\nb.  Test at the 5% level for a correlation or linear relationship between the weight of cars and mileage.","srcMarkdownNoYaml":"\n\n```{r chapter-10-setup, include= FALSE, echo=FALSE, warning=FALSE}\nlibrary(\"mosaic\") \nlibrary(\"NHANES\")\nMetacarpal<- read.csv( \"https://krkozak.github.io/MAT160/metacarpal.csv\")\nHouse<- read.csv( \"https://krkozak.github.io/MAT160/house.csv\")\nFertility<- read.csv( \"https://krkozak.github.io/MAT160/fertility.csv\") \nFert_prenatal<- read.csv( \"https://krkozak.github.io/MAT160/fertility_prenatal.csv\") \nHotdog<-read.csv( \"https://krkozak.github.io/MAT160/hotdog_beef_poultry.csv\") \n```\n\n**Before you begin, Click to expand the box below to review the process for importing a dataset.**\n\n::: {#Importing-Beer_data-to-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'}  Importing Data to Rguroo\"} \n\n1. Open the **Data** toolbox in Rguroo.  \n2. From the [Data Import]{.dpd} dropdown, select [Dataset Repository]{.fun}.  \n3. In the top search box, type [kozak]{.typein}, then select the [Statistics Using Technology – Kozak]{.repo} repository.  \n4. In the middle search box, type the first few letters of the dataset name, and choose your desired dataset name that appears in the lower panel.  \n5. Click the [Import]{.button}. The dataset will be imported to your Rguroo account.\n6. Click [Close]{.button} to exit the dialog.  \n7. To view the dataset, double-click the dataset name under the **Data** toolbox list.\n\n:::\n\n\n\n\nThe previous chapter focused on comparing populations to determine whether there is a difference between them. In those situations, we examined two random variables that measured the same or very similar quantities. In this chapter, we shift our focus to situations where the variables do not need to measure the same thing. Instead of comparing groups, we investigate whether a relationship exists between two or more variables. To study this relationship, we use regression to model the linear relationship between variables and correlation to measure the strength and direction of that linear relationship.\n\nThere are many types of relationships that can exist between variables, not just linear ones. In this book, we will focus only on linear relationships. However, it is important to recognize that other types of relationships can also be used to describe and model data, depending on the situation.\n\n## Regression\n\n### Introduction to Regression and Correlation\n\nWhen comparing different variables, two questions naturally arise: “Is there a relationship between the variables?” and “How strong is that relationship?” These questions can be answered using regression and correlation. Regression helps determine whether a relationship exists (in this book, we focus only on linear relationships), while correlation measures the strength of the linear relationship.\n\nWhen comparing different variables, two questions naturally arise: “Is there a relationship between the variables?” and “How strong is that relationship?” These questions can be answered using **regression** and **correlation**. Regression helps determine whether a relationship exists (in this book, we focus only on linear relationships), while correlation measures the strength of the linear relationship.\n\nTo better understand these ideas, it is helpful to clearly define the roles the variables play in this analysis. The **response** variable is the variable whose variability we are trying to explain or predict. The variable used to explain the change (or variability) in the response variable is called the **explanatory variable** or **predictor variable**. More generally, any variables that help explain changes in a response variable are referred to as **predictors** or **covariates**. To introduce the concepts of regression and correlation more fully, it is helpful to examine a set of data.\n\n::: {#exm-determine-relationship}\n## Determining if There is a Relationship\n\nIs there a relationship between the alcohol content and the number of calories in a 12-ounce beer? To determine whether such a relationship exists, we examine a dataset of 227 beers that includes their alcohol content and calorie counts (Find Out How Many Calories in Beer?, 2019). \n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this example is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [beer_data]{.data}.\nTable @tbl-Beer displays the first five rows of the dataset. A complete description of the variables is provided in the  [dataset code book](#code-book-beer) that follows.\n\n:::\n\n```{r chapter-10-beer-data, echo=FALSE}\n#| tbl-alt: \"Head of beer Dataset\"\n#| label: tbl-Beer\n#| tbl-cap: \"Alcohol and Calorie Content in Beer\"\nBeer <- read.csv( '/Users/mori/CSU Fullerton Dropbox/Mortaza Jamshidian/Statistics Text Using Rguroo Positron/Statistics-Using-Technology-book/Datasets Revised or New/beer_data.csv') \nknitr::kable(head(Beer))\n```\n\n::: {#code-book-beer .callout-tip .codebook collapse=\"true\"}\n\n## Code book for Dataset Beer\n\n**Description** Collection of the most popular beers from large breweries. The data is of the calories, carbs and alcohol of a specific beer. The data is shown for a 12 ounce serving. The collection includes both domestic and import beer. For the imported beers the information is per 12 oz. serving even though many imports come in pints.\n\nThis dataset contains the following columns:\n\n[beer]{.var}: The name of the beer.\n\n[brewery]{.var}: the brewery that brews the beer.\n\n[location]{.var}: whether the beer is brewed in the U.S. (domestic) or brewed in another country (import).\n\n[alcohol]{.var}: the percent alcohol content of the beer.\n\n[calories]{.var}: the number of calories in the beer.\n\n[carbs]{.var}: the amount of carbohydrates in the beer (g).\n\n[Source](https://www.beer100.com/beer-calories): Find Out How Many Calories in Beer? (n.d.). Retrieved July 21, 2019. (https://www.beer100.com/beer-calories)\n\nReferences: (Find Out How Many Calories in Beer?, 2019)\n\n:::\n\n**Solution** \n\nTo aid in figuring out if there is a relationship between the alcohol content and the number of calories, it helps to draw a scatter plot of the data. First, it is helpful to state the variables, and since variables in an algebra class are typically represented as $x$ and $y$, we use those labels  here. It helps to state which variable is $x$ (explanatory or predictor) and which is $y$ (response).\n\nState variables\n\n$x$ = percent alcohol content in the beer; [alcohol]{.var}\n\n$y$ = number of calories in 12 ounce beer; [calories]{.var}\n\n\n:::: {#Creating-scatterplot-of-Calories-vs-Alcohol-Content-in-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Creating scatter plot of Calories vs. Alcohol Content\"}\n\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Plots** toolbox in Rguroo.  \n2. Open the [Create Plot]{.dpd} dropdown and select [scatter plot]{.fun}. This opens the scatter plot dialog.  \n3. In the scatter plot dialog, choose the [beer_data]{.data} dataset from the [Dataset]{.dpd} dropdown.  \n4. Choose the [alcohol]{.var} variable from the [Predictor (x)]{.dpd} dropdown.  \n5. Choose the [calories]{.var} variable from the [Response (y)]{.dpd} dropdown.  \n6. **(Optional)** In the **Label** section of the dialog:  \n   - Enter [Calories versus Alcohol Content in Beer]{.typein} in the [Title]{.des} textbox.  \n   - Enter [Alcohol Content]{.typein} in the [X-Axis]{.des} textbox.  \n   - Enter [Number of Calories]{.typein} in the [Y-Axis]{.des} textbox.  \n7. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to see a preview of the scatter plot.\n8. In the ![Save as](Rguroo_Icons/save_as.png) textbox, enter the name [AlcoholCalorieScatter]{.typein} for the scatter plot.\nClick the button to save the scatter plot to your Rguroo account.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![scatter plot dialog showing settings for plotting alcohol content versus calories.\n](Rguroo_dialogs/Regression/scatterplot_dialog.png){width=500px}\n\n:::\n\n::::\n\n```{r,echo=FALSE}\n#| fig-alt: \"Scatter plot of alcohol content versus calories with dots following somewhat along a line\"\n#| warning: FALSE\n#| label: fig-Beer-point\n#| fig-cap: \"Calories versus Alcohol Content in Beer\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieScatter.svg\")\n```\n\nThe scatter plot shown in @fig-Beer-point looks fairly linear, meaning the points tend to fall along a straight-line pattern rather than a curved one.\n\n### Finding the regression line\n\nTo find the equation for the linear relationship, the process of regression is used to determine the line that best fits the data (sometimes called the best-fitting line). The process is to draw a line through the data and measure the vertical distance from each point to the line. These distances are called the **residuals**. The regression line is the line that makes the sum of the square of the residuals as small as possible, which is why it is sometimes called the least squares line. @fig-Beer-point-line displays the regression line on the scatter plot of the Number of Calories versus Alcohol Content.\n\n```{r beer10-point-lm, echo=FALSE}\n#| fig-alt: \"Scatter plot with regression line on plot\"\n#| warning: FALSE\n#| label: fig-Beer-point-line\n#| fig-cap: \"Scatter Plot of Beer Data with Regression Line\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieScatterLS.svg\")\n```\n\nTo add a regression (least squares) line to the scatter plot in Rguroo, you simply select the checkbox [LS Line]{.des} in the **superimpose** section of the [Scatterplot]{.dialog} dialog, as shown in @fig-scatterplot_dialog_LS. \n\n```{r scatterplot_dialog_LS, echo=FALSE}\n#| fig-alt: \"Rguroo Dialog Showing How to Add a Regression Line\"\n#| warning: FALSE\n#| label: fig-scatterplot_dialog_LS\n#| fig-cap: \"Rguroo Dialog Showing How to Add a Regression Line\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_dialogs/Regression/scatterplot_dialog_LS.png\")\n```\n\n\nGiven a collection of paired sample data, the regression equation is $\\hat{y}=b +mx$, where the slope = $m$ and the $y$-intercept = $(0,b)$. \n\n\nThe **independent variable** (the $x$-value) corresponds to the **explanatory** or **predictor** variable, the variable used to predict or explain changes in another variable. The **dependent variable** (the $y$-value) corresponds to the **response** variable—the variable whose values change in relation to the predictor. In our example, alcohol content is the predictor (independent, $x$) variable, and the number of calories is the response (dependent, $y$) variable, since it makes more sense to predict calories from alcohol content rather than vice versa.\n\nThe **residuals** are the difference between the actual observed values of the response and the corresponding estimated (predicted) values, namely $\\text{residual} = y - \\hat{y}$.\n\nAs we will show, the [Linear Regression]{.fun} function in the Analytics toolbox is used in Rguroo to fit a linear model, producing both the equation of the regression line and the associated residuals.\n\n### The Regression Equation and Prediction\n\n::: {#exm-find-regression-equation}\n\n## Find the Equation of the Regression Line\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer? To determine if there is one, we examine the sample of beer's alcohol content and calories, portion of which is shown in @tbl-Beer (Find Out How Many Calories in Beer?, 2019).\n\na.  Find the regression equation between alcohol content and calories.\nb.  Use the regression equation to find the number of calories when the alcohol content is 7%.\nc.  Use the regression equation to find the number of calories when the alcohol content is 14%.\n\n:::\n\n**Solution**\n\na.  Find the regression equation between alcohol content and calories.\n\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nClick to expand the box below to see how to obtain the regression equation.\n\n:::: {#Finding-the-Regression-Equation-in-Rguroo .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Finding the Regression Equation for the Beer Data\"}\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Analytics** toolbox in Rguroo.  \n2. Open the [Analysis]{.dpd} dropdown and select [Linear Regression]{.fun} → [Simple Regression]{.fun}. This opens the Simple Linear Regression dialog.  \n3. From the [Dataset]{.dpd} dropdown, choose the [beer_data]{.data} dataset.  \n4. From the [Predictor (x)]{.dpd} dropdown, choose the [alcohol]{.var} variable.  \n5. From the [Response (y)]{.dpd} dropdown, choose the [calories]{.var} variable.  \n6. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to view a preview of the regression results.\n7. Click the ![Save as](Rguroo_Icons/save_as.png) button to save the regression results as [AlcoholCalorieRegress]{.typein}.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![Simple Linear Regression dialog in Rguroo](Rguroo_dialogs/Regression/AlcoholCalorieRegress_dialog.png){width=500px}\n\n:::\n\n::: {.callout-tip .inner-callout collapse=\"true\" title=\"Rguroo output: Linear Regression for Beer Data\"}\n\n<div tabindex=\"0\" class=\"rg-iframe-wrapper\">\n  <iframe\n    src=\"Rguroo_html_output/RegressionHtmlOtput/AlcoholCalorieRegress_docx/AlcoholCalorieRegress.html\"\n    class=\"rg-iframe\"\n    title=\"Rguroo output: Linear Regression for Beer Data\">\n  </iframe>\n</div>\n\n:::\n\n::::\n\n```{r chapter-10-beer-lm-model, echo=FALSE, eval=FALSE}\nlm(calories~alcohol, data=Beer)\n```\n\nThe following is a portion of the output from Rguroo for this regression analysis.\n\n```{r AlcoholCalorieLSEstimates, echo=FALSE}\n#| label: tbl-Beer-lm-model\n#| tbl-cap: \"Data and model summary for Alcohol Content versus Calories\"\n#| out-width: \"90%\"\n#| fig-alt: \"Regression output for alcohol content versus calories\"\n#| warning: FALSE\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieLSEstimates.png\")\n```\n\nThis table shows various information about the regression analysis. In particular, the last row, labeled “Equation of Least Squares Line,” gives the estimates for the slope and the $y$-intercept. Note that the equation states *calories* in place of $y$ and *alcohol* in place of $x$.\n\nFrom this, rounding the values,  you can see that the y-intercept is 14.5 and the slope is 2672.4. So the regression equation is $\\hat{y}=2672.4x+14.5$.\n\nRemember, this is an estimate for the true regression equation. A different sample would produce a different estimate.\n\nWhat does the slope mean in the context of this problem?\n\nThe number of calories increases by about 26.72 calories for every 1% increase in alcohol content. In the regression output, the slope is shown as 2672, which looks much larger. This happens because alcohol content is recorded in the data as a decimal rather than a percent. For example, 1% alcohol is written as 0.01 in the dataset. The slope of 2672 therefore represents the change in calories for a 1.00 (or 100%) increase in alcohol content. To interpret the slope in terms of a 1% increase, we divide 2672 by 100, which gives 26.72 calories.\n\nThe $y$-intercept in many cases is meaningless. In this case, it means that if a drink has 0 alcohol content, then it would have 14.3 calories which maybe a reasonable value. \n\nb.  Use the regression equation to find the number of calories when the alcohol content is 7.00%.\n\nTo make a prediction, we substitute the given alcohol content (expressed as a decimal) into the regression equation and compute the corresponding fitted value. In this example, we want to predict the number of calories for a beer with 7% alcohol content. Since 7% expressed as a decimal is 0.07, we substitute $x = 0.07$ into the regression equation:\n$$\n\\hat{y} = 2672 \\times 0.07 + 14.3 = 201.34.\n$$\n\nThis value, 201.34, is the predicted number of calories for a beer whose alcohol content is 7\\%. So, if you are drinking a beer that has 7\\% alcohol content, then it probably has close to 200 calories.\n\nConsidering all the data, the mean number of calories is 154.5. However, for beers with 7\\% alcohol content, the predicted value of 201 calories is a more appropriate estimate because the beers in the dataset with 7\\% alcohol all have between 160 and 231 calories. Thus, when estimating calories for a specific alcohol content, the regression equation provides a more relevant and accurate estimate than simply using the overall mean.\n\nc.  Use the regression equation to find the number of calories when the alcohol content is 14%.\n\n$$\\hat{y}=2672*0.14+14.3=388.38$$\n\nYou can also use Rguroo to obtain predicted values for specified value of $x$. For example, to get the predicted values for alcohol contents of 7% and 14%, enter 0.07 and 0.14 (separated by a comma) in the textbox labeled [Predict at new x value(s)]{.des} in the [Simple Linear Regression]{.dialog} dialog as shown in @fig-AlcoholCalorieRegress_pred below. \n\n```{r AlcoholCalorieRegress_pred, echo=FALSE}\n#| fig-alt: \"Predicting calories for alcohol contents of 7.00% and 14.00% in Rguroo\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_pred\n#| fig-cap: \"Predicting Calories for Alcohol Contents of 7.00% and 14.00% in Rguroo\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_pred.png\")\n```\n\n\nThe predicted values output from Rguroo is shown in @fig-AlcoholCaloriePredOutput below. These values are the same as those that we computed using the formula directly.\n\n```{r AlcoholCaloriePredOutput, echo=FALSE}\n#| fig-alt: \"Rguroo output showing predicted calories for alcohol contents of 7.00% and 14.00%\"\n#| warning: FALSE\n#| label: fig-AlcoholCaloriePredOutput\n#| fig-cap: \"Rguroo Output Showing Predicted Calories for Alcohol Contents of 7.00% and 14.00%\"\n#| out-width: \"90%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/AlcoholCaloriePredOutput.png\")\n```\n\n**Extrapolation and Interpolation**\n\nIf you are drinking a beer that is 14% alcohol content, then it probably has close to 388 calories. Since, on average, a 12% alcohol beer has 330 calories, you might expect a 14% beer to have more calories than this. However, the maximum alcohol content in our dataset is 12%. The estimate for a 14% beer is therefore an example of **extrapolation**, because it is a prediction for an $x$-value outside the range of the data used to fit the model. It is not a good idea to predict values that fall far outside the range of the original data, because we cannot be sure that the regression relationship remains valid beyond the observed $x$-values.\n\nNotice that 7% alcohol is within the range of the original $x$-values. Predicting a value for an $x$-value inside the observed range is called **interpolation**. When you interpolate, you can usually feel confident that the predicted value will be close to the true value because the model was created using data within that range and is intended to describe relationships only there. When you extrapolate, however, you cannot be sure the prediction is close to the true value, because the relationship may change for $x$-values beyond those observed when the model was created.\n\n<!-- Discuss: The following example is not clear and its relationship to linear regression is not clear. . So I replaced it.\n\nAnother example of extrapolation is when you use regression to come up with an equation to predict the growth of a city, like Flagstaff, AZ. Based on analysis it was determined that the population of Flagstaff would be well over 50,000 by 1995. However, when a census was undertaken in 1995, the population was less than 50,000. This is because they extrapolated and the growth factor they were using had obviously changed from the early 1990's. Growth factors can change for many reasons, such as employment growth, employment stagnation, disease, articles saying great place to live, etc. Realize that when you extrapolate, your predicted value may not be anywhere close to the actual value that you observe.\n-->\n\nAnother example of extrapolation is the relationship between age and height.\nThis relationship is approximately linear only during middle childhood,\nroughly between ages 2 and 10. Suppose we model height (in inches) as a\nlinear function of age (in years) using the equation\n\nHeight = 30 + 2.5 × Age.\n\nFor example, to predict the height of a child who is 6 years old\n(an interpolation because 6 is within the 2–10 range), we substitute Age = 6:\n\nHeight = 30 + 2.5 × 6 = 45 inches.\n\nHowever, using the same model to predict height at age 30 represents an\nextrapolation, since age 30 is far outside the range where the linear\nrelationship holds. Substituting Age = 30 gives:\n\nHeight = 30 + 2.5 × 30 = 105 inches,\n\na clearly unrealistic value. This illustrates why extrapolation can lead\nto misleading conclusions.\n\nBy the way, the slope of 2.5  here means that for every one year increase in age, the height increases by 2.5 inches. However, in this case, the $y$-intercept is not meaningful. The $y$-intercept is 30 inches, which would be the predicted height of a newborn baby (age 0). This is not a reasonable value since newborn babies are typically about 20 inches long. So in this case, the $y$-intercept is not meaningful. \n\n<!-- Revised: This may be reasonable, but remember this value is an extrapolation so it may be wrong. (Mynote: actually it is not an extrapolation since 0% is within the range of possible alcohol content) \n--->\n\nConsider the residuals again. According to the data, a beer with 7.0% alcohol has between 160 and 231 calories. The predicted value is 201 calories. This variation means that the actual value was between 40 calories below and 30 calories above the predicted value. That isn't that far off. Some of the actual values differ by a large amount from the predicted value. This is due to variability in the response variable. The larger the residuals the less the model explains the variability in the response variable. There needs to be a way to calculate how well the model explains the variability in the response variable. This will be explored in the next section.\n\n\n### Checking Assumptions for the Regression Equation {#sec-assumption-validity-line}\n\nTwo assumptions must hold for the least squares regression equation to be valid: **randomness** and **linearity**.\n\n**Randomness**\n\nFor the linear regression model to be valid, the set of ordered pairs should be a random sample from the population of all such possible pairs.\n\nThe assumption of randomness ensures that the data are representative of the population and that the observed relationship is not the result of a systematic bias in how the data were collected. If the data are not obtained randomly—for example, if certain observations are more likely to be included than others—then the regression results may not generalize beyond the observed data.\n\nFor the beer data, do we have a random sample of alcohol content and calories? There is no guarantee that this was a random sample. The data was collected off of a website, and the website does not say how the data was obtained. However, it is a collection of most popular beers from large breweries, so it may be alright that it isn't a random sample.\n\n**Linearity**\n\nThe assumption of linearity means that the relationship between the explanatory variable and the response variable can be reasonably described by a straight line. In particular, for any given $x$-value, the average (mean) of the corresponding $y$-values should lie on, or very close to, the least squares regression line. This does not mean that all points fall on the line, but that the overall trend in the data follows a linear pattern.\n\nThe assumption of linearity is essential. If the relationship between the two variables is not linear, then a regression line will not fit the data well. To check linearity, we look at the scatter plot: a roughly straight-line pattern suggests the assumption is reasonable, while a curved pattern suggests it is not. We can also examine the so called residual-versus-fit plot. If the residuals are randomly scattered around the horizontal line $y = 0$ on this plot, the linearity assumption is likely valid. If the residuals show a curved pattern, then the assumption of linearity is likely violated.\n\nIs the assumption of linearity valid for the beer data? We examine two graphs to check this condition: the scatter plot of $y$ versus $x$ and the residual-versus-fit plot.\n\n@fig-Beer-point shows the scatter plot of calories versus alcohol content. This graph is also shown as part of the default output of the [Linear Regression]{.fun} function in Rguroo. This scatter plot looks fairly linear, so this condition appears to be satisfied.\n\n@fig-Beer-resvsfit shows the residual-versus-fit plot, which is also part of the [Linear Regression]{.fun} function output in Rguroo. The points on this plot are obtained by calculating the fitted values and the residuals for each data point. For each $x$-value, a predicted value for $y$ is computed using the equation of the least squares line; this predicted value is called the *fitted value* and is denoted by $\\hat{y}$. The residual is then found by subtracting the fitted value from the observed $y$-value: \n\n$$\n\\mbox{residual} = y - \\hat{y}.\n$$\n\nFor the beer data, the points in the residual-versus-fitted plot shown in @fig-Beer-resvsfit appear to be randomly scattered around the horizontal line at zero. There is no apparent curved pattern in the plot, suggesting that the linearity condition is satisfied.\n\n```{r AlcoholCalorieResvsFit, echo=FALSE}\n#| fig-alt: \"Residuals versus Fitted values plot looks random\"\n#| warning: FALSE\n#| label: fig-Beer-resvsfit\n#| fig-cap: \"Residuals versus Fitted Values Plot for Beer Data\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieResvsFit.png\")\n```\n\n\nRguroo calculates fitted values and residuals automatically. Continuing with the Rguroo instructions for fitting the regression equation to the beer data, shown [here](#Finding-the-Regression-Equation-in-Rguroo), selecting the checkbox [Predictions & Residuals]{.des} in the [Simple Linear Regression]{.dialog} dialog produces a table containing the fitted values (column labeled Predicted Value) and the residuals (column labeled Residual Value). The dialog box used for this step is shown in @fig-AlcoholCalorieResidualsDialog, and the Rguroo output, containing the fitted values and residuals for the first 20 cases of the beer data is given in @tbl-Beer-residuals-rguroo. It is these values that are plotted in @fig-Beer-resvsfit.\n\n```{r AlcoholCalorieResidualsDialog, echo=FALSE}\n#| fig-alt: \"Simple Regression Dialog for Showing How to Obtain the Fitted Values and Residuals\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieResidualsDialog\n#| fig-cap: \"Simple Regression Dialog for Showing How to Obtain the Fitted Values and Residuals\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_dialogs/Regression/AlcoholCalorieResidualsDialog1.png\")\n```\n\n```{r AlcoholCalorieResiduals, echo=FALSE}\n#| fig-alt: \"Fitted Values and Residuals for the first 20 cases of the Beer Data\"\n#| warning: FALSE\n#| label: tbl-Beer-residuals-rguroo\n#| fig-cap: \"Fitted Values and Residuals for the first 20 cases of the Beer Data\"\n#| out-width: \"90%\"\n\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieResiduals.png\")\n```\n\n\n\n```{r chapter-10-beer-residuals, echo=FALSE, eval=FALSE}\n#| tbl-alt: \"Residuals for Alcohol and Calorie Content in Beer\"\n#| label: tbl-Beer-residuals\n#| tbl-cap: \"Residuals for Alcohol and Calorie Content in Beer\"\nlm_out_beer<-lm(calories~alcohol, data=Beer) \nknitr::kable(residuals(lm_out_beer))\n```\n\n\n```{r Beer10-point-residuals, echo=FALSE, eval=FALSE}\n#| fig-alt: \"Residual plot of beer data, looks random\"\n#| warning: FALSE\n#| label: fig-Beer-residuals\n#| fig-cap: \"Residual Plot of Beer Data\"\ngf_point(residuals(lm_out_beer)~alcohol, data=Beer, title=\"Residuals for Calories in beer\", xlab=\"Alcohol Content\", ylab=\"Residuals for Number of Calories\") \n```\n\n### Checking Assumptions for Confidence Intervals and Tests {#sec-assumption-validity-inference} \n\nJust as with inference for means and proportions that you are already familiar with, we can construct confidence intervals and hypothesis tests for the slope and intercept of the regression line, as well as for predicted values $\\hat{y}$. These ideas are covered in @sec-inference-regression.\n\nTwo assumptions of constant variance and normality are primarily needed for the validity of inference in regression, **constant variance** and **normality**.\n\n**Constant Variance**\n\nThe assumption of constant variance is a requirement that the variance of the $y$-values should be the same across all $x$-values. \n\nTo check the constant-variance, we examine the residual-versus-fit plot: if the residuals are scattered with roughly the same vertical spread around the horizontal line $y = 0$ across all fitted-values, the assumption is reasonable. A funnel-shaped pattern suggests that unequal variances. \n\n@fig-inference-check shows four common patterns in a residual-versus-fitted plot. In panel (a), the residuals are evenly scattered above and below the horizontal line at 0 with roughly the same vertical spread across the fitted values, which is consistent with constant variance. Panels (b) and (c) show fan-shaped patterns, where the spread of the residuals changes as the fitted values change; these patterns suggest non-constant variance. Panel (d) shows a curved pattern in the residuals, which suggests that a straight-line model is not appropriate. In other words, it indicates possible nonlinearity, a violation of the linearity assumption discussed earlier.\n\n\n```{r inference-check, echo=FALSE}\n#| fig-alt: \"Various Patterns for Residual Versus Fitted Values\"\n#| warning: FALSE\n#| label: fig-inference-check\n#| fig-cap: \"Various Patterns for Residual Versus Fitted Values\"\n#| out-width: \"90%\"\n\nknitr::include_graphics(\"Rguroo_outputs/Regression/Inference_check.png\")\n```\n\n\n\nLooking again at the residual-versus-fit plot @fig-Beer-resvsfit for the beer data, the vertical spread of the residuals appears to be roughly the same across all fitted-values. There does not appear to be a funnel-shaped pattern, so this condition appears to be satisfied.\n\n**Normality**  \n\nThe normality assumption means that for any fixed value of $x$, the distribution of the corresponding $y$-values is approximately normal. In practice, this means the residuals at each $x$-value should be roughly symmetric and bell-shaped. \n\nTo check normality, we look at a histogram or a *normal probability plot* of the residuals. The histogram should appear bell-shaped, and in a normal probability plot the residuals should fall roughly along a straight line; pronounced curvature or outliers indicate that the normality assumption may not be satisfied.\n\nTo check this assumption for the beer data, we examine the normal probability plot of the residuals shown in @fig-Beer-QQ, which is also part of the [Linear Regression]{.fun} function output in Rguroo. In this plot, the residuals fall roughly along a straight line, so this condition appears to be satisfied. More specifically, all points lie within the confidence bands (shown as red dotted curves), and there is no pronounced curvature or outliers.\n\n```{r AlcoholCalorieQQ, echo=FALSE}\n#| fig-alt: \"Normal probability plots. The points seem to be roughly linear.\"\n#| warning: FALSE\n#| label: fig-Beer-QQ\n#| fig-cap: \"Normal Probability Plot for Beer Data\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieQQ.png\")\n```\n\n### Regression with Groups\n\nOne last thing that you may wonder is if imported beer has a different number of calories than domestic beer. The location (imported versus domestic) is a covariate, a third variable that may affects the calorie content. A covariate that is a categorical variable is referred to as a **factor**. You can create a scatter plot that  displays the data separately for each category of this covariate (factor). \n\nClick to expand the box below to see how to create a scatter plot of calories vs. alcohol content separated by location.\n\n:::: {#Creating-scatterplot-of-Calories-vs-Alcohol-location .callout-note appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"![](Rguroo_Icons/R_circle_logo.svg){width=22px style='vertical-align:middle;'} Creating scatter plot of Calories vs. Alcohol Content by Location\"}\n\n**Before you begin:** Make sure you have already imported the [beer_data]{.data} dataset into your Rguroo account, as shown [here](#Importing-Beer_data-to-Rguroo).\n\n1. Open the **Plots** toolbox in Rguroo.  \n2. Open the [Create Plot]{.dpd} dropdown and select [scatter plot]{.fun}. This opens the scatter plot dialog.  \n3. In the scatter plot dialog, choose the [beer_data]{.data} dataset from the [Dataset]{.dpd} dropdown.  \n4. Choose the [alcohol]{.var} variable from the [Predictor (x)]{.dpd} dropdown.  \n5. Choose the [calories]{.var} variable from the [Response (y)]{.dpd} dropdown.\n6. Choose the [location]{.var} variable from the [Factor]{.dpd} dropdown.\n7. In the **superimpose** section of the dialog, select the checkbox [LS Line by Factor]{.des}.  \n8. **(Optional)** In the **Label** section of the dialog:  \n   - Enter [Calories versus Alcohol Content in Beer by Location]{.typein} in the [Title]{.des} textbox.  \n   - Enter [Alcohol Content]{.typein} in the [X-Axis]{.des} textbox.  \n   - Enter [Number of Calories]{.typein} in the [Y-Axis]{.des} textbox.  \n9. Click the preview icon ![preview icon](Rguroo_Icons/preview_inline.png) to see a preview of the scatter plot.\n10. In the ![Save as](Rguroo_Icons/save_as.png) textbox, enter the name [AlcoholCalorieLocationScatter]{.typein} for the scatter plot.\nClick the button to save the scatter plot to your Rguroo account.\n\n::: {.callout-tip .inner-callout appearance=\"simple\" collapse=\"true\" icon=\"none\" title=\"Click here to see the Rguroo dialog\"}\n\n![scatter plot dialog showing settings for plotting alcohol content versus calories by location, including least square lines.\n](Rguroo_dialogs/Regression/scatterplot_dialog_factor.png){width=500px}\n\n:::\n\n::::\n\n\n```{r AlcoholCalorieLocationScatter, echo=FALSE}\n#| fig-alt: \"scatter plot of Calories versus Alcohol Content of Beer separated by Location\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieLocationScatter\n#| fig-cap: \"Calories versus Alcohol Content of Beer separated by Location\"\n#| out-width: \"80%\"\nknitr::include_graphics(\"Rguroo_outputs/Regression/AlcoholCalorieLocationScatter.svg\")\n```\n\n\n```{r Beer10a-point-lm, echo=FALSE, eval=FALSE}\n#| fig-alt: \"Scatter plot with linear regression line faccetted by domestic and import.\"\n#| warning: FALSE\n#| label: fig-Beer-point-lm\n#| fig-cap: \"Calories versus Alcohol Content of Beer separated by Location\"\ngf_point(calories~alcohol, data=Beer, title=\"Calories versus Alcohol Content of Beer separated by Location\", color=~location, xlab=\"Alcohol Content\", ylab=\"Number of calories\") |>\n  gf_lm() \n```\n\n@fig-AlcoholCalorieLocationScatter shows the scatter plot of calories versus alcohol content separated by location (imported versus domestic). The least squares lines for each location are also shown. Looking at the scatter plot, there doesn't appear to be an affect from domestic or import. This is what is nice about scatter plots, You can visually see a possible relationships.\n\n### Homework for Regression Section\n\n**For each problem, state the variables. The datasets in this section are used in the homework for sections 10.2 and 10.3 also.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected and are in @tbl-Metacarpal (\"Prediction of height\" 2013). \nCreate a scatter plot and find a regression equation between the height of a person and the length of their metacarpal. Then use the regression equation to find the height of a person for a metacarpal length of 44 mm and for a metacarpal length of 55 mm. Which height that you calculated do you think is closer to the true height of the person? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n**Code book for Dataset Metacarpal is below @tbl-Metacarpal.**\n\n</div>\n\n2.  @tbl-House contains the value of the house and the amount of rental income in a year that the house brings in (\"Capital and rental\" 2013). Create a scatter plot and find a regression equation between house value and rental income. Then use the regression equation to find the rental income of a house worth \\$230,000 and for a house worth \\$400,000. Which rental income that you calculated do you think is closer to the true rental income? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n**Code book for Dataset House is below @tbl-House.**\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at\" 2013) and the fertility rate per woman in the country (\"Fertility rate\" 2013). The Dataset for countries for the year 2011 are in @tbl-Fertility. Create a scatter plot of the Dataset and find a linear regression equation between fertility rate and life expectancy in 2011. Then use the regression equation to find the life expectancy for a country that has a fertility rate of 2.7 and for a country with fertility rate of 8.1. Which life expectancy that you calculated do you think is closer to the true life expectancy? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The Dataset for the countries where this information is available in @tbl-Fert_prenatal. Create a scatter plot of the Dataset and find a regression equation between percentage spent on health expenditure and the percentage of women receiving prenatal care. Then use the regression equation to find the percent of women receiving prenatal care for a country that spends 5.0% of GDP on health expenditure and for a country that spends 12.0% of GDP. Which prenatal care percentage that you calculated do you think is closer to the true percentage? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n5.  The height and weight of baseball players are in @tbl-Baseball (\"MLB heightsweights\" 2013). Create a scatter plot and find a regression equation between height and weight of baseball players. Then use the regression equation to find the weight of a baseball player that is 75 inches tall and for a baseball player that is 68 inches tall. Which weight that you calculated do you think is closer to the true weight? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n</div>\n\n```{r chapter-10-baseball-data, echo=FALSE}\n#| tbl-alt: \"Head of Heights and Weights of Baseball Players Dataset\"\n#| label: tbl-Baseball\n#| tbl-cap: \"Heights and Weights of Baseball Players\"\nBaseball <- read.csv( \"https://krkozak.github.io/MAT160/baseball.csv\") \nknitr::kable(head(Baseball))\n```\n\n\n::: {#code-book-baseball .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Baseball\n\n**Description**\n\nThe heights and weights of MLB players.\n\nFormat\n\nThis Dataset contains the following columns:\n\nPlayer: Player in the sample\n\nheight: height of baseball player (inches)\n\nweight: weight of baseball player (pounds)\n\n[Source](http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_MLB_HeightsWeights) MLB heightsweights. (2013, November 16).\n\nReferences SOCR Dataset of MLB Heights Weights from UCLA.\n\n:::\n\n6.  Different species have different body weights and brain weights are in @tbl-Body. (\"Brain2bodyweight\" 2013). Create a scatter plot and find a regression equation between body weights and brain weights. Then use the regression equation to find the brain weight for a species that has a body weight of 62 kg and for a species that has a body weight of 180,000 kg. Which brain weight that you calculated do you think is closer to the true brain weight? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n</div>\n\n```{r Chapter-10-Body-data, echo=FALSE}\n#| tbl-alt: \"Head of Body Weights and Brain Weights of Species\"\n#| label: tbl-Body\n#| tbl-cap: \"Body Weights and Brain Weights of Species\"\nBody <- read.csv( \"https://krkozak.github.io/MAT160/body.csv\") \nknitr::kable(head(Body))\n```\n\n::: {#code-book-body .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Body\n\n**Description**\n\nThe body weight, brain weight, and brain/body proportion of different species of animals.\n\nFormat\n\nThis Dataset contains the following columns:\n\nspecies: species of animal\n\nbodyweight: the body weight of the species (kg)\n\nbrainweight: the brain weight of the species (kg)\n\nbrainbodyproportion: the ratio of brain weight to body weight of the species\n\nSource Brain2bodyweight. (2013, November 16). Retrieved from http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_Brain2BodyWeight\n\nReferences SOCR Data of species body weights and brain weights from UCLA.\n\n:::\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs\" 2013.) The first six rows of the dataset are shown in @tbl-Hotdog. Create a scatter plot and find a regression equation between amount of calories and amount of sodium. Then use the regression equation to find the amount of sodium a hot dog has if it is 170 calories and if it is 120 calories. Which sodium level that you calculated do you think is closer to the true sodium level? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n\n</div>\n\n```{r Chapter10-Hotdog-data, echo=FALSE}\n#| tbl-alt: \"Head of Body Weights and Brain Weights of Species\"\n#| label: tbl-Hotdog\n#| tbl-cap: \"Hotdog Dataset\"\nBody <- read.csv( \"https://krkozak.github.io/MAT160/hotdog_beef_poultry.csv\") \nknitr::kable(head(Hotdog))\n```\n\n\n::: {#code-book-hotdogs .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset hotdogs\n\n**Description**\n\nThis dataset contains nutritional information for a sample of commercially available hot dogs. The data include calorie counts and sodium content for each hot dog, along with a categorical classification of the hot dog type. The dataset is commonly used to illustrate comparisons of quantitative variables across groups.\n\nVariables  \n[type]{.var}  \nCategorical variable indicating the type of hot dog. Typical categories include Beef, Meat, and Poultry.\n\n[calories]{.var}  \nQuantitative variable giving the number of calories per hot dog.\n\n[sodium]{.var}  \nQuantitative variable giving the sodium content per hot dog, measured in milligrams.\n\nSource  \nThe dataset is widely used in introductory statistics textbooks and examples and is often attributed to a Consumer Reports–style nutritional analysis of hot dog brands.\n:::\n\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in @tbl-Agriculture (\"OECD economic development\" 2013). Create a scatter plot and find a regression equation between percent of labor force in agriculture and per capita income. Then use the regression equation to find the per capita income in a country that has 21 percent of labor in agriculture and in a country that has 2 percent of labor in agriculture. Which per capita income that you calculated do you think is closer to the true income? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n</div>\n\n\n```{r chapter-10-agricultue-data, echo=FALSE}\n#| tbl-alt: \"Head of Percent of Labor in Agriculture and Per Capita Income for European Countries\"\n#| label: tbl-Agriculture\n#| tbl-cap: \"Percent of Labor in Agriculture and Per Capita Income for European Countries\"\nAgriculture <- read.csv( \"https://krkozak.github.io/MAT160/agriculture.csv\") \nknitr::kable(head(Agriculture))\n```\n\n::: {#code-book-agriculture .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Agriculture**\n\n**Description**\n\nThe per capita income and percent in different industries in European countries\n\nFormat\n\nThis Dataset contains the following columns:\n\ncountry: country in Europe\n\npercapita: per captia income\n\nagriculture: percentage of workforce in agriculture\n\nindustry: percentage of workforce in industry\n\nservices: percentage of workforce in services\n\n[Source](http://lib.stat.cmu.edu/DASL/Datafiles/oecdat.html) OECD economic development. (2013, December 04).\n\nReferences Data And Story Library\n\n:::\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are in the dataset [cancer_1]{.data} (\"Smoking and cancer\" 2013). The first six rows of the data is shown in @tbl-Cancerbladder. Create a scatter plot and find a regression equation between number of cigarettes smoked and number of deaths from bladder cancer. Then use the regression equation to find the number of deaths from bladder cancer when the cigarette sales were 20 per capita and when the cigarette sales were 6 per capita. Which number of deaths that you calculated do you think is closer to the true number? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\n```{r chapter-10-cancer-data, echo=FALSE}\n#| tbl-alt: \"Head of Number of Cigarettes and Number of Bladder Cancer Deaths\"\n#| label: tbl-Cancerbladder\n#| tbl-cap: \"Number of Cigarettes and Number of Bladder Cancer Deaths\"\nCancer <- read.csv( \"https://krkozak.github.io/MAT160/cancer_1.csv\") \nknitr::kable(head(Cancer))\n```\n\n::: {#code-book-cancer .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Cancer\n\n**Description** This Dataset contains the number of cigarette sales (per Capita), number of cancer Deaths (per 100 Thousand) from bladder, lung, kidney, and leukemia.\n\nFormat\n\nThis Dataset contains the following columns:\n\nstate: state in US\n\ncig: the number of cigarette sales (per capita)\n\nbladder: number of deaths per 100 thousand from bladder cancer\n\nlung: number of deaths per 100 thousand from lung cancer\n\nkidney: number of deaths per 100 thousand from kidney cancer\n\nleukemia: number of deaths per 100 thousand from leukemia\n\n[Source](http://lib.stat.cmu.edu/DASL/Datafiles/cigcancerdat.html) Smoking and cancer. (2013, December 04).\n\nReferences Data And Story Library\n\n:::\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and the first six rows are shown in @tbl-Cars (\"us auto mileage,\" 2019). Create a scatter plot and find a regression equation between weight of cars and mileage. Then use the regression equation to find the mileage on a car that weighs 3800 pounds and on a car that weighs 2000 pounds. Which mileage that you calculated do you think is closer to the true mileage? Why?\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n</div>\n\n```{r chapter-10-cars-data, echo=FALSE}\n#| tbl-alt: \"Head of Weights and Mileages of Carss\"\n#| label: tbl-Cars\n#| tbl-cap: \"Weights and Mileages of Cars\"\nCars<- read.csv( \"https://krkozak.github.io/MAT160/cars.csv\") \nknitr::kable(head(Cars))\n```\n\n::: {#code-book-cars .callout-tip .codebook collapse=\"true\"}\n## Code book for Dataset Cars\n\n**Description** \n\nVariation in gasoline mileage among makes and models of automobiles is influenced substantially by the weight and horsepower of the vehicles. When miles per gallon and horsepower are transformed to logarithms, the linearity of the regression is improved. A negative second order term is required to fit the logarithmic mileage to weight relation. If the logged variables are standardized, the coefficients of the first order terms indicate the standard units change in log mileage per one standard unit change in the predictor variable at the (logarithmic) mean. This change is constant in the case of mileage to horsepower, but not for mileage to weight. The coefficient of the second order weight term indicates the change in standardized slope associated with a one standard deviation increase in the logarithm of weight.\n\nFormat\n\nThis Dataset contains the following columns:\n\nmake: the type of car\n\nvol: cubic feet of cab space\n\nhp: engine horsepower\n\nnpg: the average mileage of the car\n\nsp: top speed (mph)\n\nwt: the weight of the car (100 pounds)\n\nSource (n.d.). Retrieved July 21, 2019, from https://www3.nd.edu/\\~busiforc/handouts/Data and Stories/regression/us auto mileage/usautomileage.html\n\nReferences R.M. Heavenrich, J.D. Murrell, and K.H. Hellman, Light Duty Automotive Technology and Fuel Economy Trends Through 1991, U.S. Environmental Protection Agency, 1991 (EPA/AA/CTAB/91-02).\n\n:::\n\n## Correlation \n\n<!-- Rewrote this section to explain correlation more and how to find it in Rguroo. Also have a smooth transition to R^2 -->\n\nA correlation exists between two variables when the values of one variable are associated with the values of the other variable. Correlation is a word used in everyday life, and many people think they understand what it means. What it really means, when stated as a number, is a measure of how strong the linear relationship is between two variables. This measure is called the **correlation coefficient**, or **correlation** for short. It is also called the **Pearson correlation coefficient** after Karl Pearson who developed it. There are many types of patterns (relationships) between variables that one can see in data. Common types of patterns are linear, exponential, logarithmic, or periodic. To see these patterns, you can draw a scatter plot of the data. In this chapter, and generally in this course, we mostly deal with linear relationships.\n\n### Interpretation of the correlation coefficient\n\nThe correlation coefficient is a number between −1 and 1 and is usually denoted by the letter $r$. A value of $r = 1$ indicates a perfect positive linear relationship, and a value of $r = -1$ indicates a perfect negative linear relationship. A perfect linear relationship means that all of the data points lie exactly on a straight line.\n\nThe strength of the linear relationship depends on how close $r$ is to 1 or −1. Values of $r$ close to these extremes indicate a strong linear relationship, while values closer to 0 indicate a weaker linear relationship. A correlation of $r = 0$ means there is no linear relationship between the two variables.\n\nThe sign of $r$ describes the direction of the relationship. A positive correlation means that as one variable increases, the other variable tends to increase. A negative correlation means that as one variable increases, the other variable tends to decrease.\n\n<!--\n$r$ is always between $-1$ and 1. $r$ = $-1$ means there is a perfect negative linear correlation and $r$ = 1 means there is a perfect positive correlation. The closer $r$ is to 1 or $-1$, the stronger the correlation. The closer $r$ is to 0, the weaker the correlation. CAREFUL: $r$ = 0 does not mean there is no correlation. It just means there is **no linear correlation**. There might be a very strong curved pattern.\n-->\n\n::: {#exm-correlation-interpretation}\n## Calculating the Linear Correlation Coefficient, $r$\n\nHow strong is the positive relationship between alcohol content and the number of calories in a 12-ounce beer? To answer this question, compute the correlation between alcohol content and calories using the [beer]{.data} dataset (“Calories in Beer,” 2011). The first six rows of this dataset are shown in @tbl-Beer. Use Rguroo to find the correlation coefficient and then interpret its value.\n\n:::\n\n\n** Solution** \n\nYou can obtain the correlation coefficient, $r$, in Rguroo from the output of the [Linear Regression]{.fun} function. To obtain this value for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo).\n\nFor these data the correlation coefficient between alcohol content and calories is 0.9036. This value appears in the _Data and Model Summary_ table of the regression function output in the row labeled [Pearson Correlation (r)]{.des}; see @tbl-Beer-lm-model, and it indicates a strong positive linear relationship between alcohol content and calories, since the value of $r$ is close to 1. Also, since $r$ is positive, it means that as alcohol content increases, the number of calories tends to increase as well.\n\n<!--\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFrom example 10.2.1, $R^2=0.8164$. The correlation coefficient = $r=\\sqrt{r^2}=\\sqrt{0.8164}=0.9035486$, or use this command in r\n\n```{r}\ncor(calories~alcohol, data=Beer)\n```\n\nThe scatter graph went up from left to right, so the correlation coefficient is positive. Since 0.90 is close to 1, then that means there is a fairly strong positive correlation.\n\n-->\n\n\n\n<!-- However, it doesn't give you a strong indication of how well the relationship explains the variability in the response variable, and it doesn't work for more than two variables. There is a way to look at how much of the relationship explains the variability in the response variable.\n-->\n\n### Coefficient of Determination, $R^2$\n\nCorrelation is related to another measure that explains how much of the variability in the response variable is explained by the explanatory variable. The variability in a response variable can be due to many factors. Some of the variability is explained by the explanatory variable and some is due to other factors. For example, in the beer example, some of the variability in calories is explained by alcohol content and some is due to other factors, such as other ingredients in the beer. There is a way to measure how much of the variability in the response variable is explained by the explanatory variable. This measure is called the **coefficient of determination**, denoted by $R^2$ (read R-squared), and its value is the square of the correlation.\n\n<!-- There is some variability in the response variable values, such as calories. Some of the variation in calories is due to alcohol content and some is due to other factors. How much of the variation in the calories is due to alcohol content?\n-->\n\nAs an example, using the beer data, we want to understand how much of the variation in calories is explained by alcohol content and how much is due to other factors, such as ingredients. For instance, two beers can have the same alcohol content but different numbers of calories because they contain different ingredients. A linear regression of calories on alcohol content explains the part of the variation in calories that is associated with alcohol content. The remaining variation is due to other factors and random differences between beers, and is not explained by the regression. Together, the explained and unexplained parts account for all of the variability in calories:\n\n(total variation) = (explained variation) + (unexplained variation)\n\nThe proportion of the variation that is explained by the model is $R^2=\\frac{\\text{explained variation}}{\\text{total variation}}$.\n\nThis is known as the **coefficient of determination**.\n\n:::{#exm-coefficient-determination}\n## Calculating the Coefficient of Determination, $R^2$\n\nHow well does the alcohol content of a beer explain the variability in the number of calories in 12-ounce beer? To determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer.\n:::\n\n**Solution**\n\nYou can obtain the coefficient of determination, $R^2$, in Rguroo from the output of the [Linear Regression]{.fun} function. To obtain the coefficient of determination for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo).\n\nFor these data, the coefficient of determination between alcohol content and calories is 0.8164. This value appears in the _Data and Model Summary_ table of the regression function output in the row labeled [Coefficient of Determination (R-squared)]{.des}; see @tbl-Beer-lm-model. This value indicates that 81.64% of the variability in calories is explained by alcohol content, while the remaining 18.36% is due to other factors.\n\nA high coefficient of determination (for example, above 0.8) means that only a small portion of the variability is unexplained. In this situation, alcohol content alone explains most of the variability in calories, so there may be little need to include additional explanatory variables to improve the model.\n\n<!--\n\nState random variables\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFirst find and name the linear model, how about lm_out_beer, so you can refer to it. Then use the command\n\n```{r chapter-10-beer-lm, echo=TRUE, eval=FALSE}\nlm_out_beer<-lm(calories~alcohol, data=Beer) #creates the linear model and calls it lm_out_beer \nrsquared(lm_out_beer) #finds the rsquared of the linear model created.\n```\n\nThe $R^2=0.8164$. Thus, 81.64% of the variation in calories is explained to the linear relationship between alcohol content and calories. The other 18.36% of the variation is due to other factors. \n\nThis is all you have to do to find how much of the variability in the response variable is explained by the linear model.\n\n-->\n\nThere is a relationship between correlation coefficient $r$ and the coefficient of determination $R^2$, namely $r = \\pm\\sqrt{R^2}$.\nThe question is which sign, plus ($+$) or minus ($-$), should be used. If the relationship is positive (that is, the slope of the regression line is positive), use the $+$ sign. If the relationship is negative (the slope is negative), use the $-$ sign. In other words, assign to $r$ the same sign as the slope of the linear regression line.\n\n<!--\nYou can also use this command and r will give you the correct sign.\n\ncor(respose_variable\\~explanatory_variable, data=Data_Frame)\n\nThe **linear correlation coefficient** is a number that describes the strength of the linear relationship between the two variables. It is also called the Pearson correlation coefficient after Karl Pearson who developed it.\n\n-->\n\n### Causation\n\nOne common mistake people make is to assume that because there is a correlation between two variables, then one variable causes the other. This is usually not the case. That would be like saying the amount of alcohol in the beer causes it to have a certain number of calories. However, fermentation of sugars is what causes the alcohol content. The more sugars you have, the more alcohol can be made, and the more sugar, the higher the calories. It is actually the amount of sugar that causes both. Do not confuse the idea of correlation with the concept of causation. Just because two variables are correlated does not mean one causes the other to happen. However, the new theory is showing that if you have a relationship between two variables and a strong correlation, and you can show that there are no other variables that could explain the change, then you can show causation. This is how doctors have shown that smoking causes kidney cancer. Just realize that proving that one caused the other is a difficult process, and causation should not be just assumed.\n\n::: {#exm-correlation-causation}\n## Correlation Versus Causation Examples\n\n<!--We probably should reconsider these two examples.-->\n\na.  A study showed a strong linear correlation between per capita beer consumption and teacher's salaries. Does giving a teacher a raise cause people to buy more beer? Does buying more beer cause teachers to get a raise?\n\nThere is probably some other factor causing both of them to increase at the same time. Think about this: In a town where people have little extra money, they won't have money for beer and they won't give teachers raises. In another town where people have more extra money to spend it will be easier for them to buy more beer and they would be more willing to give teachers raises.\n\nb.  A study shows that there is a correlation between people who have had a root canal and those that have cancer. Does that mean having a root canal causes cancer?\n\n:::\n\nJust because there is positive correlation doesn't mean that one caused the other. It turns out that there is a positive correlation between eating carrots and cancer, but that doesn't mean that eating carrots causes cancer. In other words, there are lots of relationships you can find between two variables, but that doesn't mean that one caused the other.\n\nRemember a correlation only means a pattern exists. It does not mean that one variable causes the other variable to change.\n\n### Homework for Correlation Section\n\n**For each problem, state the random variables.The Dataset in this section are in section 10.1 and will be used in section 10.3.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected. The data are in the [height_vs_metacarp]{.data} dataset, and the first six rows of the data are shown in @tbl-Metacarpal (\"Prediction of height,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n\n**Code book for Dataset Metacarpal is below** @tbl-Metacarpal.\n\n</div>\n\n2.  @tbl-House contains the first six values of the house and the amount of rental income in a year that the house brings in (\"Capital and rental,\" 2013). Use the [house]{.data} dataset to find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n\n**Code book for Dataset House is below @tbl-House.**\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at,\" 2013) and the fertility rate per woman in the country (\"Fertility rate,\" 2013). The first siz rows of the [Life_exp_fert_rate]{.data} dataset for countries for the year 2011 are in @tbl-Fertility. Use the dataset to find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The data for the countries where this information is available is in the  [fertility_prenatal]{.data} dataset and the first six rows of the data are given in @tbl-Fert_prenatal. Find the coefficient of determination and the correlation coefficient between the percentage spent on health expenditure and the percentage of women receiving prenatal care, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n5.  The height and weight of baseball players are in the [baseball]{.data} dataset and the first six rows of the data are shown in @tbl-Baseball (\"MLB heightsweights,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n**Code book for Dataset Baseball is below @tbl-Baseball.**\n\n</div>\n\n6.  Different species have different body weights and brain weights. The dataset [body]{.data} contains data about these two variables, and @tbl-Body shows the first six rows of the dataset (\"Brain2bodyweight,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n**Code book for Dataset Body is below @tbl-Body.**\n\n</div>\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs,\" 2013). The data are in [hotdog]{.data} dataset with the first six rows shown in @tbl-Hotdog. Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n**Code book for Dataset Hotdog is below @tbl-Hotdog.**\n\n</div>\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in the dataset [agriculture]{.data}. The first six rows are shon in  @tbl-Agriculture (\"OECD economic development,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n**Code book for Dataset Agriculture is @tbl-Agriculture.**\n\n</div>\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are given in the dataset [cancer_1]{.data} with the first six rows showing in  @tbl-Cancerbladder (\"Smoking and cancer,\" 2013). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\nThe codebook for the dataset cancer is given [here](#code-book-cancer)\n\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and are in [cars]{.data} dataset. The first six rows of the data are shown in @tbl-Cars (\"us auto mileage,\" 2019). Find the coefficient of determination and the correlation coefficient, then interpret both.\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n**Code book for Dataset Cars is below @tbl-Cars.**\n\n</div>\n\n11. There is a correlation between police expenditure and crime rate. Does this mean that spending more money on police causes the crime rate to decrease? Explain your answer.\n\n12. There is a correlation between tobacco sales and alcohol sales. Does that mean that using tobacco causes a person to also drink alcohol? Explain your answer.\n\n13. There is a correlation between the average temperature in a location and the mortality rate from breast cancer. Does that mean that higher temperatures cause more women to die of breast cancer? Explain your answer.\n\n14. There is a correlation between the length of time a tableware company polishes a dish and the price of the dish. Does that mean that the time a plate is polished determines the price of the dish? Explain your answer.\n\n## Inference for Regression and Correlation {#sec-inference-regression}\n\nThe idea behind regression is to find an equation that relates the response variable to the explanatory variables, and then use that equation to predict values of the response variable from values of the explanatory variables. But how do you know how good that estimate is?\n\nWhen we use a regression equation to make a prediction, the predicted value is only a single number. In practice, however, there is almost always some uncertainty in that prediction. Even if we knew the true relationship between the variables, individual observations would still vary around that relationship due to natural randomness and factors not included in the model.\n\nBecause of this variability, it is usually more informative to give a range of plausible values for the response variable rather than a single predicted value. A prediction interval provides such a range. It gives an interval of values that is likely to contain the response value for a new observation with specified explanatory variable values, along with a stated level of confidence.\n\n<!-- I am removing computation of standard error since students do not use this for anything in their computations. We will focus on obtaining prediction intervals. \n First you need a measure of the variability in the estimate, called the standard error of the estimate. The definition of the **standard error of the estimate** is how much error is in the estimate from the regression equation.\n\n**Standard Error of the Estimate** formula $S_e=\\sum{(\\hat{y}-y)^2}$\n\nThis formula is hard to work with but luckily r Studio will calculate it for you. In fact the command has already been used, so this information is already found. The command is\n\nsummary(lm_out) #lm_out is the name you gave the linear model\n\n### Example: Finding the Standard Error of the Estimate\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer? To determine if there is a sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019), in @tbl-Beer. Find the standard error of the estimate.\n\n**Code book for Dataset Beer is below @tbl-Beer.**\n\n#### Solution\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nFirst save the linear model with a name like lm_out_beer. Then use summary(lm_out_beer) to find the standard error of the estimate.\n\n```{r chapter-10-beer-lm-out}\nlm_out_beer=lm(calories~alcohol, data=Beer) \nsummary(lm_out_beer)\n```\n\nThe standard error of the estimate is the residual standard error in the output. So the standard error of the estimate for the number of calories in a beer related to alcohol content is $S_e=17.62$\n\n-->\n\n### Prediction Interval\n\nUsing the regression equation you can predict the number of calories from the alcohol content. However, you only find one value. The problem is that beers vary a bit in calories even if they have the same alcohol content. It would be nice to have a range instead of a single value. The range is called a prediction interval.\n\n### Prediction Interval for an Individual $y$\n\nGiven the fixed value $x$, a prediction interval for the response at $x$ is $\\hat{y}\\pm E$ where $\\hat{y}$ is the predicted value from the regression equation and $E$ is the margin of error for the prediction.\n\nRguroo will calculate the prediction interval for you in the [Linear Regression]{.fun} function. You just have to give it the value of $x$ that you want to predict for, and tell it you want a prediction interval.\n\n### Example: Find the Prediction Interval\n\nIs there a relationship between the alcohol content and the number of calories in 12-ounce beer?\nTo determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer. Find a 95% prediction interval for the number of calories when the alcohol content is 7.0%.\n\n#### Solution\n\nTo obtain the prediction interval for the beer example, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo). Additionally, in the [linear Regression]{.fun} dialog box, enter the value of alcohol content (0.07) in the textbox labeled [Predict at new x value(s)]{.des}. Then click the tab labeled [Prediction Interval]{.des} and select the checkboxes labeled [Prediction Interval]{.des}. These steps are shown in @fig-AlcoholCalorieRegress_pred_interval. \n\n```{r AlcoholCalorieRegress_pred_interval, echo=FALSE}\n#| fig-alt: \"Rguroo dialog for obtaining prediction interval for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_pred_interval\n#| fig-cap: \"Rguroo dialog for obtaining prediction interval for calories from alcohol content\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_pred_interval.png\")\n```\n\nThe output containing the prediction interval is shown in @fig-Beer-pred-interval.\n\n```{r Beer-pred-interval, echo=FALSE}\n#| fig-alt: \"Rguroo output showing prediction interval for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-Beer-pred-interval\n#| fig-cap: \"Rguroo output showing prediction interval for calories from alcohol content\"\n#| out-width: \"85%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/Beer-pred-interval.png\")  \n```\n\n<!---\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\nComputing the prediction interval using r Studio\n\n```{r chapter-10-beer-predict, eval = FALSE, echo=FALSE}\npredict(lm_out_beer, newdata=list(alcohol=0.07), interval = \"prediction\", level=0.95) \n```\n\n--->\n\nThe value 201.592 is the model’s predicted number of calories for a beer with 7.0% alcohol. The prediction interval is shown in the columns labeled _Lower Pred Limit (2.5%)_ and _Upper Pred Limit (97.5%)_. This means we can be 95% confident that the actual number of calories for a beer with 7.0% alcohol lies between 166.7 and 236.5. This range is called a 95% prediction interval.\n\nYou can obtain prediction intervals for other alcohol contents by entering different values in the textbox labeled [Predict at new x value(s)]{.des} in the [Linear Regression]{.fun} dialog box. You can also change the confidence level using the textbox labeled [Confidence Level]{.des} in the [Confidence Interval]{.des} tab.\n\n### Hypothesis Test for Correlation or Slope:\n\nHow do we decide whether there is really a correlation or a linear relationship between two variables? Can we test whether such a relationship exists? The answer is yes. We can test for correlation, or we can test whether the slope of the regression line is zero.\n\nThese two tests are equivalent. If there is a correlation between the variables, then the slope of the regression line is not zero. Likewise, if the slope of the regression line is not zero, then there is a correlation between the variables. For this reason, testing for correlation and testing for slope lead to the same conclusion.\n\nThe steps for performing a hypothesis test for correlation are given below. You can use these steps to test for correlation or to test whether the slope is zero.\n\n1.  State the variables in words.\n\n  $x$ = explanatory variable\n\n  $y$ = response variable\n\n2.  State the null and alternative hypotheses and the level of significance\n\n$H_o: \\text{there is not a correlation}$\n\n$H_a: \\text{there is a correlation}$\n\nOr equivalently\n\n$H_o: \\text{the slope is zero}$\n\n$H_a: \\text{the slope is not zero}$\n\nAlso, state $\\alpha$, the significance level for your test.\n\n3.  State and check the conditions for the hypothesis test, as explained in @sec-assumption-validity-line (Assumptions for Validity of the Regression Equation and Line) and @sec-assumption-validity-inference (Assumptions for Validity of Inference).\n\n4.  Find the test statistic and p-value\n\nThis will be calculated by Rguroo.\n\n5.  Conclusion\n\nThis is where you write reject $H_o$ or fail to reject $H_o$. The rule is: if the p-value $<\\alpha$, then reject $H_o$. If the p-value $\\ge \\alpha$, then fail to reject $H_o$\n\n6.  Interpretation\n\nThis is where you interpret in real world terms the conclusion to the test. The conclusion for a hypothesis test is that you either have enough evidence to support $H_a$, or you do not have enough evidence to support $H_a$.\n\n### Example: Testing the Claim of a Linear Correlation\n\nIs there a linear relationship, or correlation, between the alcohol content and the number of calories in 12-ounce beer? To determine this, use the sample of beer's alcohol content and calories (Find Out How Many Calories in Beer?, 2019) in the [beer]{.data} dataset. The first six rows of this dataset is shown in @tbl-Beer. Test at the 5% level.\n\n#### Solution\n\n1.  State the random variables in words.\n\n$x$ = alcohol content in the beer\n\n$y$ = calories in 12 ounce beer\n\n2.  State the null and alternative hypotheses and the level of significance\n\n$H_o: \\text{there is not a correlation}$\n\n$H_a: \\text{there is a correlation}$\n\nlevel of significance $\\alpha=0.05$\n\n3.  State and check the conditions for the hypothesis test\n\nThe conditions for the hypothesis test were already checked in [Example: Find the Equation of the Regression Line]\n\n4.  Find the test statistic and p-value\n\nTo obtain the test statistic and p-value, follow the steps for creating a linear regression model [here](#Finding-the-Regression-Equation-in-Rguroo). Additionally, in the [linear Regression]{.fun} dialog box, under the [Test of Association]{.des} tab, check the box labeled [Slope]{.des}, and under the **method** section select [Theoretical t-statistic]{.des}. These steps are shown in @fig-AlcoholCalorieRegress_test. The default value for the significance level is 0.05, so you do not need to change that value. However, if you want to change it, you can do so in the textbox labeled [Significance Level]{.des}.\n\n```{r AlcoholCalorieRegress_test, echo=FALSE}\n#| fig-alt: \"Rguroo dialog for testing slope for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_test\n#| fig-cap: \"Rguroo dialog for testing slope for calories from alcohol content\"\n#| out-width: \"80%\"\nknitr::include_graphics(\n  \"Rguroo_dialogs/Regression/AlcoholCalorieRegress_test.png\")\n\n```\n\nThe output containing the result of the test shown in @fig-AlcoholCalorieRegress_test_out.\n\n```{r AlcoholCalorieRegress_test_out, echo=FALSE}\n#| fig-alt: \"Result of Rguroo hypothesis test for slope for calories from alcohol content\"\n#| warning: FALSE\n#| label: fig-AlcoholCalorieRegress_test_out\n#| fig-cap: \"AlcoholCalorieRegress_test_out\"\n#| out-width: \"85%\"\nknitr::include_graphics(\n  \"Rguroo_outputs/Regression/AlcoholCalorieRegress_test_out.png\")\n  \n```\n\n```{r chapter-10-beer-test, eval=FALSE, echo=FALSE}\nlm_out_beer<-lm(calories~alcohol, data=Beer) \nsummary(lm_out_beer)\n```\n\nThe test statistic is the t value in the column labeled _Obs t Stat_. In this case the t-statistic is 31.634, and the p-value id $8.84X10^{-85}$.\n\n5.  Conclusion\n\nReject $H_o$ since the p-value is less than 0.05.\n\n6.  Interpretation\n\nThere is enough evidence to show that there is a correlation between alcohol content and number of calories in a 12-ounce bottle of beer.\n\n### Homework for Inference for Regression and Correlation Section\n\n**For each problem, state the random variables. The Dataset in this section are in the homework for section 10.1 and were also used in section 10.2.**\n\n1.  When an anthropologist finds skeletal remains, they need to figure out the height of the person. The height of a person (in cm) and the length of their metacarpal bone 1 (in mm) were collected. The data are in the [height_vs_metacarp]{.data} dataset, and the first six rows of the data are shown in @tbl-Metacarpal (\"Prediction of height,\" 2013).\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [height_vs_metacarp]{.data}.\n\n**Code book for Dataset Metacarpal is below @tbl-Metacarpal.**\n\na.  Compute a 99% prediction interval for height of a person with a metacarpal length of 44 mm.\nb.  Test at the 1% level for a correlation or linear relationship between length of metacarpal bone 1 and height of a person.\n\n</div>\n\n2.  @tbl-House contains the first six values of the house and the amount of rental income in a year that the house brings in (\"Capital and rental,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [house]{.data}.\n\n**Code book for Dataset House is below @tbl-House.**\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the rental income on a house worth \\\\\\$230,000.\nb.  Test at the 5% level for a correlation or linear relationship between house value and rental amount.\n\n</div>\n\n3.  The World Bank collects information on the life expectancy of a person in each country (\"Life expectancy at,\" 2013) and the fertility rate per woman in the country (\"Fertility rate,\" 2013). The first siz rows of the [Life_exp_fert_rate]{.data} dataset for countries for the year 2011 are in @tbl-Fertility. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [Life_exp_fert_rate]{.data}.\n\n**Code book for Dataset Fertility is below @tbl-Fertility.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 99% prediction interval for the life expectancy for a country that has a fertility rate of 2.7.\nb.  Test at the 1% level for a correlation or linear relationship between fertility rate and life expectancy.\n\n4.  The World Bank collected data on the percentage of gross domestic product (GDP) that a country spends on health expenditures (Current health expenditure (% of GDP), 2019), the fertility rate of the country (Fertility rate, total (births per woman), 2019), and the percentage of woman receiving prenatal care (Pregnant women receiving prenatal care (%), 2019). The data for the countries where this information is available is in the  [fertility_prenatal]{.data} dataset and the first six rows of the data are given in @tbl-Fert_prenatal. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [fertility_prenatal]{.data}.\n\n\n**Code book for Dataset Fert_prenatal is below @tbl-Fert_prenatal.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the percentage of woman receiving prenatal care for a country that spends 5.0 % of GDP on health expenditure.\nb.  Test at the 5% level for a correlation or linear relationship between percentage spent on health expenditure and the percentage of women receiving prenatal care.\n\n5.  The height and weight of baseball players are in the [baseball]{.data} dataset and the first six rows of the data are shown in @tbl-Baseball (\"MLB heightsweights,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [baseball]{.data}.\n\n**Code book for Dataset Baseball is below @tbl-Baseball.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the weight of a baseball player that is 75 inches tall.\nb.  Test at the 5% level for a correlation or linear relationship between height and weight of baseball players.\n\n\n6.  Different species have different body weights and brain weights. The dataset [body]{.data} contains data about these two variables, and @tbl-Body shows the first six rows of the dataset (\"Brain2bodyweight,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [body]{.data}.\n\n**Code book for Dataset Body is below @tbl-Body.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 99% prediction interval for the brain weight for a species that has a body weight of 62 kg.\nb.  Test at the 1% level for a correlation or linear relationship between body weights and brain weights.\n\n\n7.  A sample of hot dogs was taken and the amount of sodium (in mg) and calories were measured. (\"Data hotdogs,\" 2013). The data are in [hotdog]{.data} dataset with the first six rows shown in @tbl-Hotdog. \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [hotdog]{.data}.\n\n**Code book for Dataset Hotdog is below @tbl-Hotdog.**\n\n</div>\n\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the amount of sodium a beef hot dog has if it is 170 calories.\nb.  Test at the 5% level for a correlation or linear relationship between amount of calories and amount of sodium.\n\n8.  Per capita income in 1960 dollars for European countries and the percent of the labor force that works in agriculture in 1960 are in the dataset [agriculture]{.data}. The first six rows are shon in  @tbl-Agriculture (\"OECD economic development,\" 2013).\n\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [agriculture]{.data}.\n\n**Code book for Dataset Agriculture is @tbl-Agriculture.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate.-->\nb.  Compute a 90% prediction interval for the per capita income in a country that has 21 percent of labor in agriculture.\nc.  Test at the 5% level for a correlation or linear relationship between percent of labor force in agriculture and per capita income.\n\n9.  Cigarette smoking and cancer have been linked. The number of deaths per one hundred thousand from bladder cancer and the number of cigarettes sold per capita in 1960 are given in teh dataset [cancer_1]{.data} with the first six rows showing in  @tbl-Cancerbladder (\"Smoking and cancer,\" 2013). \n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cancer_1]{.data}.\n\n</div>\n\nThe codebook for the dataset cancer is given [here](#code-book-cancer)\n\n\n<!-- a.  Find the standard error of the estimate.-->\na.  Compute a 99% prediction interval for the number of deaths from bladder cancer when the cigarette sales were 20 per capita.\nb.  Test at the 1% level for a correlation or linear relationship between cigarette smoking and deaths of bladder cancer.\n\n10. The weight of a car can influence the mileage that the car can obtain. A random sample of cars' weights and mileage was collected and are in [cars]{.data} dataset. The first six rows of the data are shown in @tbl-Cars (\"us auto mileage,\" 2019).\n\n<div tabindex=\"0\" style=\"width:85%; margin:auto;\">\n\n![Rguroo dataset logo](Rguroo_Icons/Rguroo_repo_logo.png) The dataset for this exercise is available in the Rguroo dataset repository [Kozak]{.repo}, with the dataset name [cars]{.data}.\n\n**Code book for Dataset Cars is below @tbl-Cars.**\n\n</div>\n\n<!-- a.  Find the standard error of the estimate. -->\na.  Compute a 95% prediction interval for the mileage on a car that weighs 3800 pounds.\nb.  Test at the 5% level for a correlation or linear relationship between the weight of cars and mileage."},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","number-sections":true,"filters":["filters/class-to-macro.lua"],"css":["styles.css"],"number-offset":11,"output-file":"Regression.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Regression"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","number-sections":true,"filters":["filters/class-to-macro.lua"],"include-in-header":["_preamble.tex"],"number-offset":11,"output-file":"Regression.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"title":"Regression"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}